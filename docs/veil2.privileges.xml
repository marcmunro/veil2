<extract>
<programlisting>
create table veil2.privileges (
  privilege_id			integer not null,
  privilege_name		text not null,
  promotion_scope_type_id	integer,
  description			text
);

alter table veil2.privileges add constraint privilege__pk
  primary key(privilege_id);

alter table veil2.privileges add constraint privilege__promotion_scope_type_fk
  foreign key(promotion_scope_type_id)
  references veil2.scope_types(scope_type_id);

</programlisting>
<para>
This provides all privileges used by our VPD.  There should be no
need for anyone other than administrators having any access to this
table.
</para>
<para>
A privilege is the lowest level of access control.  It should be used to
allow the holder of that privilege to do exactly one thing, for example
'select privileges' should be used to allow the privilege holder to
select from the privileges table.  It should not be used for any other
purpose.
</para>
<para>
Note that the name of the privilege is only a clue to its usage.  We use
the privilege ids and not the names to manage access.  It is the
responsibility of the implementation to ensure that a privilege's
name matches the purpose to which it is put
</para>
<para>
Column <literal>privilege_id</literal>: Primary key for privilege.  This is the integer that will be used as a
key into our privilege bitmaps.  It is not generated from a sequence as
we want to have very tight control of the privilege_ids.
</para>
<para>
Column <literal>privilege_name</literal>: A descriptive name for a privilege.  This should generally be enough to 
figure out the purpose of the privilege.
</para>
<para>
Column <literal>promotion_scope_type_id</literal>: Identfies a security scope type to which this privileges scope should
be promoted if possible.  This allows roles which will be assigned in
a restricted security context to contain privileges which necessarily
must apply in a superior scope (ie as if they has been assigned in a
superior context).
</para>
<para>
For example a hypothetical 'select lookup' privilege may be assigned
in a team context (via a hypothetical 'team member' role).  But if the
lookups table is not in any way team-specific it makes no sense to apply
that privilege in that scope.  Instead, we will promote that privilege
to a scope where it does make sense.  See the veil docs for more on
privilege promotion and on the use of the terms scope and context.
</para>
<para>
Column <literal>description</literal>: For any privilege whose purpose cannot easily be determined from the
name, a description of the privilege should appear here.
</para>
</extract>
