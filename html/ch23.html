<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Chapter 23. How Veil2 Relates to the Original Veil</title>
<link rel="stylesheet" type="text/css" href="veil2.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="index.html" title="Veil2 0.9.1 (beta) Documentation">
<link rel="up" href="pt03.html" title="Part III. Implementation Details">
<link rel="prev" href="ch22.html" title="Chapter 22. For Developers">
<link rel="next" href="ch24.html" title="Chapter 24. Tips and Guidelines">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch22.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="pt03.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="ch24.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 22. For Developers </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Chapter 24. Tips and Guidelines</td>
</tr>
</table>
<hr>
</div>
<div class="chapter">
<div class="titlepage"><div><div><h2 class="title">
<a name="original_veil"></a>Chapter 23. How <code class="literal">Veil2</code> Relates to the Original <code class="literal">Veil</code>
</h2></div></div></div>
<p>
    Before <code class="literal">Veil2</code> there was
    <a class="ulink" href="https://github.com/marcmunro/veil" target="_top"><code class="literal">Veil</code></a>.
  </p>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="idm1965"></a>23.1. What is <code class="literal">Veil</code>?</h2></div></div></div>
<p>
      <code class="literal">Veil</code> is a data security add-on for
      Postgres.  It provides an API allowing you to control access to
      data at the row, or even column, level.  Different users will be
      able to run the same query and see different results
    </p>
<p>
      <code class="literal">Veil</code> provides a set of components for dealing
      with bitmaps as variables, and for maintaining these variables
      in shared or session state.
    </p>
<p>
      It provides the necessary tools for you to build a secured
      database system, but:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem"><p>
	    the <code class="literal">Veil</code> variables cannot be stored in
	    the database;
	  </p></li>
<li class="listitem"><p>
	    the <code class="literal">Veil</code> variables do not share in the
	    transaction management of the underlying database;
	  </p></li>
<li class="listitem"><p>
	    session and connection management is not provided.
	  </p></li>
</ul></div>
<p>
    </p>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="idm1982"></a>23.2. Where Did <code class="literal">Veil2</code> Come From?</h2></div></div></div>
<p>
      Although it was clear to the author that <code class="literal">Veil</code>
      had a serious deficiency in its lack of integration with
      Postgres' transaction management, it wasn't obvious how to
      resolve it.
    </p>
<p>
      The original <code class="literal">Veil</code> release was in 2011.  One
      of the most useful datatypes that it provided was a hash of
      bitmaps.  That is a set of bitmaps keyed by text strings.
    </p>
<p>
      The author could see no way to create a native Postgres datatype
      that could do the same thing, and so the original
      <code class="literal">Veil</code> continued as it was.
    </p>
<p>
      Eventually the author realized that the hstore module was just
      what was needed, and so set out to create a Postgres native
      bitmap type.  This was <a class="ulink" href="https://github.com/marcmunro/pgbitmap" target="_top"><code class="literal">pgbitmap</code></a>.
      It worked pretty well and was simple and elegant. All of
      <code class="literal">Veil</code> could be replaced with pgbitmap, hstore
      and arrays, with all session objects being storable in temporary
      tables and shared objects in normal tables.
    </p>
<p>
      On further reflection, the author realized that some proper
      integration was needed, along with a decent framework for
      building VPDs using pgbitmap.  It wouldn't be much work, and
      didn't need to contain much code.
    </p>
<p>
      As he tackled the problem of <code class="literal">Veil2</code>, he
      realized that much of what the user had to implement in a
      <code class="literal">Veil</code>-based system was going to be common to
      all users.  And he had a SaaS project that he'd worked on as a
      guide to what was needed.  So the project grew.
    </p>
<p>
      Ironically, as the implementation proceeded, the need for hstore
      never materialized.
    </p>
<p>
      And although it never became simple, the core concepts slowly
      crystallized, and the concept of a <a class="link" href="ch01.html" title="Chapter 1. What Is A Relational Security System?">Relational Security
      System</a> dropped out.
    </p>
<p>
      With a small number of relatively simple concepts that many
      developers, and even some PHBs could understand, it became clear
      that the underlying model was sound but that each implementation
      would be tricky and a lot of work.  This was not something that
      most developers would be given the opportunity to build for
      themselves from a set of components.  And given that the
      fundamental requirements were likely to be the same for many
      classes of problem, the direction for <code class="literal">Veil2</code>
      was set.
    </p>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch22.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="pt03.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="ch24.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 22. For Developers </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Chapter 24. Tips and Guidelines</td>
</tr>
</table>
</div>
</body>
</html>
