<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Veil2: src/veil2.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Veil2
   </div>
   <div id="projectbrief">Postgres extension for VPD implementations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('veil2_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">veil2.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides callable veil2 functions. These are written in C for performance and to ensure that they cannot be easily subverted.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;postgres.h&quot;</code><br />
<code>#include &quot;funcapi.h&quot;</code><br />
<code>#include &quot;catalog/pg_type.h&quot;</code><br />
<code>#include &quot;access/xact.h&quot;</code><br />
<code>#include &quot;executor/spi.h&quot;</code><br />
<code>#include &quot;utils/builtins.h&quot;</code><br />
<code>#include &quot;<a class="el" href="veil2_8h_source.html">veil2.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for veil2.c:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c__incl.png" border="0" usemap="#src_2veil2_8c" alt=""/></div>
<map name="src_2veil2_8c" id="src_2veil2_8c">
<area shape="rect" id="node10" href="veil2_8h.html" title="Main header file for veil2. " alt="" coords="1153,95,1215,121"/>
</map>
</div>
</div>
<p><a href="veil2_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structContextPrivs.html">ContextPrivs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSessionPrivs.html">SessionPrivs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad47704493016ed19bf02d100b3bd7a3d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ad47704493016ed19bf02d100b3bd7a3d">CONTEXT_PRIVS_INCREMENT</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:ad47704493016ed19bf02d100b3bd7a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a778fcf86d0d27dab1e71d797ae26d344"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a778fcf86d0d27dab1e71d797ae26d344">CONTEXT_PRIVS_SIZE</a>(elems)</td></tr>
<tr class="separator:a778fcf86d0d27dab1e71d797ae26d344"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a19c7f5d2df4527ab984de57559ba783e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e">findContext</a> (int *p_idx, int scope_type, int scope)</td></tr>
<tr class="separator:a19c7f5d2df4527ab984de57559ba783e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ca237d772c5c3cdaf9aaa117d11fbbb"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb">checkContext</a> (int *p_idx, int scope_type, int scope, int priv)</td></tr>
<tr class="separator:a1ca237d772c5c3cdaf9aaa117d11fbbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6708652d0e229189e124f02a78964d3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3">freeContextPrivs</a> (<a class="el" href="structContextPrivs.html">ContextPrivs</a> *cp)</td></tr>
<tr class="separator:ab6708652d0e229189e124f02a78964d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cc456848a9f63f74dfe80326e3f17a2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2">clear_session_privs</a> ()</td></tr>
<tr class="separator:a3cc456848a9f63f74dfe80326e3f17a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabe26dc105921f8fdf5304f8cb51fccb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSessionPrivs.html">SessionPrivs</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb">extendSessionPrivs</a> (<a class="el" href="structSessionPrivs.html">SessionPrivs</a> *<a class="el" href="veil2_8c.html#a35e0fd1762207cf7d5bf56ca50279232">session_privs</a>)</td></tr>
<tr class="separator:aabe26dc105921f8fdf5304f8cb51fccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a552c63ade183ba790a1fc1105117c6b5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5">add_scope_privs</a> (int scope_type, int scope, Bitmap *privs)</td></tr>
<tr class="separator:a552c63ade183ba790a1fc1105117c6b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8427f8ff086c0cfde8433b48faf005b2"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a8427f8ff086c0cfde8433b48faf005b2">fetch_scope_privs</a> (HeapTuple tuple, TupleDesc tupdesc, void *p_result)</td></tr>
<tr class="separator:a8427f8ff086c0cfde8433b48faf005b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0227b91fd8a98d84dc03bff37ea89f1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ad0227b91fd8a98d84dc03bff37ea89f1">do_load_session_privs</a> ()</td></tr>
<tr class="separator:ad0227b91fd8a98d84dc03bff37ea89f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad03876d90cc6f64b46b87bdbe6dc7289"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ad03876d90cc6f64b46b87bdbe6dc7289">load_privs</a> ()</td></tr>
<tr class="separator:ad03876d90cc6f64b46b87bdbe6dc7289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6b01654a9686d26fa3f2ee2533a619"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619">error_if_no_session</a> ()</td></tr>
<tr class="separator:a6d6b01654a9686d26fa3f2ee2533a619"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9267b3a3291b582296685bdc3dccfa1e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a9267b3a3291b582296685bdc3dccfa1e">fetch_2ints</a> (HeapTuple tuple, TupleDesc tupdesc, void *p_result)</td></tr>
<tr class="separator:a9267b3a3291b582296685bdc3dccfa1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45a90a5d613d0f79e8e18adfc0abdd66"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a45a90a5d613d0f79e8e18adfc0abdd66">create_temp_tables</a> ()</td></tr>
<tr class="separator:a45a90a5d613d0f79e8e18adfc0abdd66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a351e9c866a977deb2a28e07091adba0d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a351e9c866a977deb2a28e07091adba0d">truncate_temp_tables</a> (bool clear_context)</td></tr>
<tr class="separator:a351e9c866a977deb2a28e07091adba0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c1816e2ef1b38fdfc3abf503d3fc50"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ab1c1816e2ef1b38fdfc3abf503d3fc50">veil2_session_ready</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:ab1c1816e2ef1b38fdfc3abf503d3fc50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7ae936fa571fecaac89d8adee322ae6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#af7ae936fa571fecaac89d8adee322ae6">do_reset_session</a> (bool clear_context)</td></tr>
<tr class="separator:af7ae936fa571fecaac89d8adee322ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa978d6e0212eb0edf5436a07a4bec88d"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#aa978d6e0212eb0edf5436a07a4bec88d">veil2_reset_session</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:aa978d6e0212eb0edf5436a07a4bec88d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9a3b057ba1dea0f0db728f321fb768d"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ab9a3b057ba1dea0f0db728f321fb768d">veil2_reset_session_privs</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:ab9a3b057ba1dea0f0db728f321fb768d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eabb8210c058af3c045a215ee77b425"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a7eabb8210c058af3c045a215ee77b425">veil2_true</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a7eabb8210c058af3c045a215ee77b425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdfc74e12e705f110f1f6719ee33c7ea"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea">checkSessionReady</a> ()</td></tr>
<tr class="separator:abdfc74e12e705f110f1f6719ee33c7ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f03a4c32bbac407d040e66fcb807e48"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a0f03a4c32bbac407d040e66fcb807e48">veil2_i_have_global_priv</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a0f03a4c32bbac407d040e66fcb807e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdf7a99cee51319e393a9d0d3a1e79ef"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#abdf7a99cee51319e393a9d0d3a1e79ef">veil2_i_have_personal_priv</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:abdf7a99cee51319e393a9d0d3a1e79ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f3226ae495eaf76f2f1165026a7f0eb"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a1f3226ae495eaf76f2f1165026a7f0eb">veil2_i_have_priv_in_scope</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a1f3226ae495eaf76f2f1165026a7f0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af94dca10e6f14dc3fb20bbb288415fca"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#af94dca10e6f14dc3fb20bbb288415fca">veil2_i_have_priv_in_scope_or_global</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:af94dca10e6f14dc3fb20bbb288415fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab26e0230a290a97425e5fd7c420737b6"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ab26e0230a290a97425e5fd7c420737b6">veil2_i_have_priv_in_superior_scope</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:ab26e0230a290a97425e5fd7c420737b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b25cd404b6882e64e0d484222ee8f93"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a4b25cd404b6882e64e0d484222ee8f93">veil2_i_have_priv_in_scope_or_superior</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a4b25cd404b6882e64e0d484222ee8f93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1648915ba36e9f03b3ace8c43ad2fb9f"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a1648915ba36e9f03b3ace8c43ad2fb9f">veil2_i_have_priv_in_scope_or_superior_or_global</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a1648915ba36e9f03b3ace8c43ad2fb9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6abf74250aa0970432b45b8146643e66"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a6abf74250aa0970432b45b8146643e66">veil2_result_counts</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a6abf74250aa0970432b45b8146643e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22033ed27181d9b4943f2916394a546e"><td class="memItemLeft" align="right" valign="top">static text *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a22033ed27181d9b4943f2916394a546e">textfromstr</a> (char *in)</td></tr>
<tr class="separator:a22033ed27181d9b4943f2916394a546e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66116a3513e9a99192202401cc5f394e"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a66116a3513e9a99192202401cc5f394e">veil2_docpath</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a66116a3513e9a99192202401cc5f394e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c18f7c4ed4d0fc2aa31e942e3a194a"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a79c18f7c4ed4d0fc2aa31e942e3a194a">veil2_datapath</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a79c18f7c4ed4d0fc2aa31e942e3a194a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9206d7502b250a49f4279f788cd19c03"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a9206d7502b250a49f4279f788cd19c03">session_ready</a> = ((bool) 0)</td></tr>
<tr class="separator:a9206d7502b250a49f4279f788cd19c03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2997ca01e0a570ccaaf0b974b39bf7b6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a2997ca01e0a570ccaaf0b974b39bf7b6">result_counts</a> [] = {0, 0}</td></tr>
<tr class="separator:a2997ca01e0a570ccaaf0b974b39bf7b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35e0fd1762207cf7d5bf56ca50279232"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSessionPrivs.html">SessionPrivs</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a35e0fd1762207cf7d5bf56ca50279232">session_privs</a> = ((void *) 0)</td></tr>
<tr class="separator:a35e0fd1762207cf7d5bf56ca50279232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec6a2cdc6993e99d274ad67ebc5b85dc"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#aec6a2cdc6993e99d274ad67ebc5b85dc">session_privs_loaded</a> = ((bool) 0)</td></tr>
<tr class="separator:aec6a2cdc6993e99d274ad67ebc5b85dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides callable veil2 functions. These are written in C for performance and to ensure that they cannot be easily subverted. </p>
<div class="fragment"><div class="line">Author:       Marc Munro</div><div class="line">Copyright (c) 2020 Marc Munro</div><div class="line">License:      GPL V3</div></div><!-- fragment --> 
<p class="definition">Definition in file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad47704493016ed19bf02d100b3bd7a3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad47704493016ed19bf02d100b3bd7a3d">&#9670;&nbsp;</a></span>CONTEXT_PRIVS_INCREMENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTEXT_PRIVS_INCREMENT&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many <a class="el" href="structContextPrivs.html">ContextPrivs</a> entries a <a class="el" href="structSessionPrivs.html">SessionPrivs</a> structure will be created with/extended by. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00228">228</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a778fcf86d0d27dab1e71d797ae26d344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a778fcf86d0d27dab1e71d797ae26d344">&#9670;&nbsp;</a></span>CONTEXT_PRIVS_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTEXT_PRIVS_SIZE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">elems</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(                   \</div><div class="line">    sizeof(<a class="code" href="structSessionPrivs.html">SessionPrivs</a>) +                          \</div><div class="line">    (<span class="keyword">sizeof</span>(<a class="code" href="structContextPrivs.html">ContextPrivs</a>) *                         \</div><div class="line">     (elems + <a class="code" href="veil2_8c.html#ad47704493016ed19bf02d100b3bd7a3d">CONTEXT_PRIVS_INCREMENT</a>)))</div><div class="ttc" id="structSessionPrivs_html"><div class="ttname"><a href="structSessionPrivs.html">SessionPrivs</a></div><div class="ttdef"><b>Definition:</b> <a href="veil2_8c_source.html#l00083">veil2.c:83</a></div></div>
<div class="ttc" id="veil2_8c_html_ad47704493016ed19bf02d100b3bd7a3d"><div class="ttname"><a href="veil2_8c.html#ad47704493016ed19bf02d100b3bd7a3d">CONTEXT_PRIVS_INCREMENT</a></div><div class="ttdeci">#define CONTEXT_PRIVS_INCREMENT</div><div class="ttdef"><b>Definition:</b> <a href="veil2_8c_source.html#l00228">veil2.c:228</a></div></div>
<div class="ttc" id="structContextPrivs_html"><div class="ttname"><a href="structContextPrivs.html">ContextPrivs</a></div><div class="ttdef"><b>Definition:</b> <a href="veil2_8c_source.html#l00074">veil2.c:74</a></div></div>
</div><!-- fragment --><p>Provide the size that we want our <a class="el" href="structSessionPrivs.html">SessionPrivs</a> structure to be.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">elems</td><td>the number of <a class="el" href="structContextPrivs.html">ContextPrivs</a> entries already in place. This will be increased by CONTEXT_PRIVS_INCREMENT. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00235">235</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a552c63ade183ba790a1fc1105117c6b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a552c63ade183ba790a1fc1105117c6b5">&#9670;&nbsp;</a></span>add_scope_privs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_scope_privs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bitmap *&#160;</td>
          <td class="paramname"><em>privs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add a <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry to <a class="el" href="veil2_8c.html#a35e0fd1762207cf7d5bf56ca50279232">session_privs</a>, from the parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scope_type</td><td>The scope_type for the new entry </td></tr>
    <tr><td class="paramname">the</td><td>scope scope for the new entry </td></tr>
    <tr><td class="paramname">privs</td><td>The privileges Bitmap for the new entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00283">283</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a552c63ade183ba790a1fc1105117c6b5_cgraph.png" border="0" usemap="#veil2_8c_a552c63ade183ba790a1fc1105117c6b5_cgraph" alt=""/></div>
<map name="veil2_8c_a552c63ade183ba790a1fc1105117c6b5_cgraph" id="veil2_8c_a552c63ade183ba790a1fc1105117c6b5_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="184,5,331,32"/>
</map>
</div>

</div>
</div>
<a id="a1ca237d772c5c3cdaf9aaa117d11fbbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ca237d772c5c3cdaf9aaa117d11fbbb">&#9670;&nbsp;</a></span>checkContext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool checkContext </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>p_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>priv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wrapper for <a class="el" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e">findContext()</a> that finds the context and checks for a privilege in a single operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_idx</td><td>Pointer to a cached index value for the entry in the <a class="el" href="veil2_8c.html#a35e0fd1762207cf7d5bf56ca50279232">session_privs</a>-&gt;active_contexts that the search should start from. This allows the caller to cache the last returned index in the hope that they will be looking for the same entry next time. If no cached value exists, the caller should provide -1. The index of the found <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry will be returned through this, or -1 if no context can be found. </td></tr>
    <tr><td class="paramname">scope_type</td><td>The scope_type_id of the <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry we are looking for. </td></tr>
    <tr><td class="paramname">scope</td><td>The scope_id of the <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry we are looking for. </td></tr>
    <tr><td class="paramname">priv</td><td>The privilege to test for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>false if no context can be found, otherwise true if the user has priv in the supplied scope. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00183">183</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a1ca237d772c5c3cdaf9aaa117d11fbbb_cgraph.png" border="0" usemap="#veil2_8c_a1ca237d772c5c3cdaf9aaa117d11fbbb_cgraph" alt=""/></div>
<map name="veil2_8c_a1ca237d772c5c3cdaf9aaa117d11fbbb_cgraph" id="veil2_8c_a1ca237d772c5c3cdaf9aaa117d11fbbb_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="161,5,256,32"/>
</map>
</div>

</div>
</div>
<a id="abdfc74e12e705f110f1f6719ee33c7ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdfc74e12e705f110f1f6719ee33c7ea">&#9670;&nbsp;</a></span>checkSessionReady()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool checkSessionReady </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check whether a session has been properly initialized. If not, and we are supposed to fail in such a situation, fail with an appropriate error message. Otherwise return true if the session is ready to go.</p>
<dl class="section return"><dt>Returns</dt><dd>boolean True if our session has been properly initialized. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00644">644</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_abdfc74e12e705f110f1f6719ee33c7ea_cgraph.png" border="0" usemap="#veil2_8c_abdfc74e12e705f110f1f6719ee33c7ea_cgraph" alt=""/></div>
<map name="veil2_8c_abdfc74e12e705f110f1f6719ee33c7ea_cgraph" id="veil2_8c_abdfc74e12e705f110f1f6719ee33c7ea_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="204,56,352,83"/>
<area shape="rect" id="node3" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="415,5,549,32"/>
<area shape="rect" id="node4" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="400,56,564,83"/>
<area shape="rect" id="node9" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="423,107,541,133"/>
<area shape="rect" id="node5" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="624,31,719,57"/>
<area shape="rect" id="node8" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="612,81,731,108"/>
<area shape="rect" id="node6" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="779,31,899,57"/>
<area shape="rect" id="node7" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="947,31,1061,57"/>
</map>
</div>

</div>
</div>
<a id="a3cc456848a9f63f74dfe80326e3f17a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cc456848a9f63f74dfe80326e3f17a2">&#9670;&nbsp;</a></span>clear_session_privs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void clear_session_privs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clear all <a class="el" href="structContextPrivs.html">ContextPrivs</a> entries in session_privs. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00212">212</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a3cc456848a9f63f74dfe80326e3f17a2_cgraph.png" border="0" usemap="#veil2_8c_a3cc456848a9f63f74dfe80326e3f17a2_cgraph" alt=""/></div>
<map name="veil2_8c_a3cc456848a9f63f74dfe80326e3f17a2_cgraph" id="veil2_8c_a3cc456848a9f63f74dfe80326e3f17a2_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="200,5,327,32"/>
</map>
</div>

</div>
</div>
<a id="a45a90a5d613d0f79e8e18adfc0abdd66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45a90a5d613d0f79e8e18adfc0abdd66">&#9670;&nbsp;</a></span>create_temp_tables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void create_temp_tables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create the temporary tables used for recording session privileges and context. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00438">438</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a45a90a5d613d0f79e8e18adfc0abdd66_cgraph.png" border="0" usemap="#veil2_8c_a45a90a5d613d0f79e8e18adfc0abdd66_cgraph" alt=""/></div>
<map name="veil2_8c_a45a90a5d613d0f79e8e18adfc0abdd66_cgraph" id="veil2_8c_a45a90a5d613d0f79e8e18adfc0abdd66_cgraph">
<area shape="rect" id="node2" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="200,5,295,32"/>
<area shape="rect" id="node3" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="343,5,463,32"/>
<area shape="rect" id="node4" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="511,5,625,32"/>
</map>
</div>

</div>
</div>
<a id="ad0227b91fd8a98d84dc03bff37ea89f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0227b91fd8a98d84dc03bff37ea89f1">&#9670;&nbsp;</a></span>do_load_session_privs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void do_load_session_privs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Does the donkey-work of loading session privileges into session memory. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00338">338</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_ad0227b91fd8a98d84dc03bff37ea89f1_cgraph.png" border="0" usemap="#veil2_8c_ad0227b91fd8a98d84dc03bff37ea89f1_cgraph" alt=""/></div>
<map name="veil2_8c_ad0227b91fd8a98d84dc03bff37ea89f1_cgraph" id="veil2_8c_ad0227b91fd8a98d84dc03bff37ea89f1_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="220,5,367,32"/>
<area shape="rect" id="node4" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="593,81,740,108"/>
<area shape="rect" id="node5" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="226,107,361,133"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="246,208,341,235"/>
<area shape="rect" id="node9" href="veil2_8c.html#a8427f8ff086c0cfde8433b48faf005b2" title="fetch_scope_privs" alt="" coords="225,157,362,184"/>
<area shape="rect" id="node11" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="234,259,353,285"/>
<area shape="rect" id="node3" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="417,5,543,32"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="420,208,540,235"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="609,208,724,235"/>
<area shape="rect" id="node10" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5" title="add_scope_privs" alt="" coords="415,132,545,159"/>
</map>
</div>

</div>
</div>
<a id="af7ae936fa571fecaac89d8adee322ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7ae936fa571fecaac89d8adee322ae6">&#9670;&nbsp;</a></span>do_reset_session()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void do_reset_session </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clear_context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Does the database donkey-work for <a class="el" href="veil2_8c.html#aa978d6e0212eb0edf5436a07a4bec88d">veil2_reset_session()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clear_context</td><td>Whether veil2_session_context should be cleared as well as the privileges temp tables. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00509">509</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_af7ae936fa571fecaac89d8adee322ae6_cgraph.png" border="0" usemap="#veil2_8c_af7ae936fa571fecaac89d8adee322ae6_cgraph" alt=""/></div>
<map name="veil2_8c_af7ae936fa571fecaac89d8adee322ae6_cgraph" id="veil2_8c_af7ae936fa571fecaac89d8adee322ae6_cgraph">
<area shape="rect" id="node2" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="393,83,488,109"/>
<area shape="rect" id="node5" href="veil2_8c.html#a9267b3a3291b582296685bdc3dccfa1e" title="fetch_2ints" alt="" coords="221,32,312,59"/>
<area shape="rect" id="node6" href="veil2_8c.html#a45a90a5d613d0f79e8e18adfc0abdd66" title="create_temp_tables" alt="" coords="193,83,340,109"/>
<area shape="rect" id="node7" href="veil2_8c.html#a351e9c866a977deb2a28e07091adba0d" title="truncate_temp_tables" alt="" coords="188,133,345,160"/>
<area shape="rect" id="node3" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="536,83,656,109"/>
<area shape="rect" id="node4" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="704,83,819,109"/>
</map>
</div>

</div>
</div>
<a id="a6d6b01654a9686d26fa3f2ee2533a619"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6b01654a9686d26fa3f2ee2533a619">&#9670;&nbsp;</a></span>error_if_no_session()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool error_if_no_session </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Predicate to indicate whether to raise an error if a privilege test function has been called prior to a session being established. If not, the privilege testing function should return false. The determination of whether to error or return false is based on the value of the veil2.system_parameter 'error on uninitialized session' at the time that the database session is established.</p>
<dl class="section return"><dt>Returns</dt><dd>boolean, whether or not to raise an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00387">387</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a6d6b01654a9686d26fa3f2ee2533a619_cgraph.png" border="0" usemap="#veil2_8c_a6d6b01654a9686d26fa3f2ee2533a619_cgraph" alt=""/></div>
<map name="veil2_8c_a6d6b01654a9686d26fa3f2ee2533a619_cgraph" id="veil2_8c_a6d6b01654a9686d26fa3f2ee2533a619_cgraph">
<area shape="rect" id="node2" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="216,5,351,32"/>
<area shape="rect" id="node3" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="201,56,365,83"/>
<area shape="rect" id="node8" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="224,107,343,133"/>
<area shape="rect" id="node4" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="425,31,520,57"/>
<area shape="rect" id="node7" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="413,81,532,108"/>
<area shape="rect" id="node5" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="580,31,700,57"/>
<area shape="rect" id="node6" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="748,31,863,57"/>
</map>
</div>

</div>
</div>
<a id="aabe26dc105921f8fdf5304f8cb51fccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabe26dc105921f8fdf5304f8cb51fccb">&#9670;&nbsp;</a></span>extendSessionPrivs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structSessionPrivs.html">SessionPrivs</a>* extendSessionPrivs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSessionPrivs.html">SessionPrivs</a> *&#160;</td>
          <td class="paramname"><em>session_privs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00246">246</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a9267b3a3291b582296685bdc3dccfa1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9267b3a3291b582296685bdc3dccfa1e">&#9670;&nbsp;</a></span>fetch_2ints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool fetch_2ints </td>
          <td>(</td>
          <td class="paramtype">HeapTuple&#160;</td>
          <td class="paramname"><em>tuple</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TupleDesc&#160;</td>
          <td class="paramname"><em>tupdesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is a <a class="el" href="veil2_8h.html#a42368367f5a1eef750ff948f44890274">Fetch_fn()</a> for dealing with tuples containing 2 integers. Its job is to populate the p_result parameter with 2 integers from a Postgres SPI query.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tuple</td><td>The ::HeapTuple returned from a Postgres SPI query. This will contain a tuple of 2 integers. </td></tr>
    <tr><td class="paramname">tupdesc</td><td>The ::TupleDesc returned from the same Postgres SPI query </td></tr>
    <tr><td class="paramname">p_result</td><td>Pointer to a <a class="el" href="structtuple__2ints.html">tuple_2ints</a> struct into which the 2 integers from the SPI query will be placed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>bool</code> false, indicating to <a class="el" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49">veil2_query()</a> that no more rows are expected. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00422">422</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a8427f8ff086c0cfde8433b48faf005b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8427f8ff086c0cfde8433b48faf005b2">&#9670;&nbsp;</a></span>fetch_scope_privs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool fetch_scope_privs </td>
          <td>(</td>
          <td class="paramtype">HeapTuple&#160;</td>
          <td class="paramname"><em>tuple</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TupleDesc&#160;</td>
          <td class="paramname"><em>tupdesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A <a class="el" href="veil2_8h.html#a42368367f5a1eef750ff948f44890274">Fetch_fn</a> for <a class="el" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49">veil2_query()</a> that retrieves the details for a <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry and adds it to <a class="el" href="veil2_8c.html#a35e0fd1762207cf7d5bf56ca50279232">session_privs</a> using <a class="el" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5">add_scope_privs()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tuple</td><td>The ::HeapTuple returned from a Postgres SPI query. This will contain a tuple of 2 integers. </td></tr>
    <tr><td class="paramname">tupdesc</td><td>The ::TupleDesc returned from the same Postgres SPI query </td></tr>
    <tr><td class="paramname">p_result</td><td>This should be null.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true, to indicate to <a class="el" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49">veil2_query()</a> that there may be more records to fetch. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00318">318</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a8427f8ff086c0cfde8433b48faf005b2_cgraph.png" border="0" usemap="#veil2_8c_a8427f8ff086c0cfde8433b48faf005b2_cgraph" alt=""/></div>
<map name="veil2_8c_a8427f8ff086c0cfde8433b48faf005b2_cgraph" id="veil2_8c_a8427f8ff086c0cfde8433b48faf005b2_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5" title="add_scope_privs" alt="" coords="191,5,321,32"/>
<area shape="rect" id="node3" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="369,5,516,32"/>
</map>
</div>

</div>
</div>
<a id="a19c7f5d2df4527ab984de57559ba783e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19c7f5d2df4527ab984de57559ba783e">&#9670;&nbsp;</a></span>findContext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void findContext </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>p_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Locate a particular ContextPriv entry in <a class="el" href="veil2_8c.html#a35e0fd1762207cf7d5bf56ca50279232">session_privs</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_idx</td><td>Pointer to a cached index value for the entry in the <a class="el" href="veil2_8c.html#a35e0fd1762207cf7d5bf56ca50279232">session_privs</a>-&gt;active_contexts that the search should start from. This allows the caller to cache the last returned index in the hope that they will be looking for the same entry next time. If no cached value exists, the caller should provide -1. The index of the found <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry will be returned through this, or -1 if no context can be found. </td></tr>
    <tr><td class="paramname">scope_type</td><td>The scope_type_id of the <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry we are looking for. </td></tr>
    <tr><td class="paramname">scope</td><td>The scope_id of the <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry we are looking for. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00120">120</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="ab6708652d0e229189e124f02a78964d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6708652d0e229189e124f02a78964d3">&#9670;&nbsp;</a></span>freeContextPrivs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void freeContextPrivs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structContextPrivs.html">ContextPrivs</a> *&#160;</td>
          <td class="paramname"><em>cp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Free a <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry. This just means freeing the privileges Bitmap and zeroing the pointer for it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cp</td><td>The <a class="el" href="structContextPrivs.html">ContextPrivs</a> entry to be cleared out. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00201">201</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="ad03876d90cc6f64b46b87bdbe6dc7289"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad03876d90cc6f64b46b87bdbe6dc7289">&#9670;&nbsp;</a></span>load_privs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void load_privs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Manage the conditional loading of session privileges into session memory. If the session is already loaded, it does nothing. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00368">368</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_ad03876d90cc6f64b46b87bdbe6dc7289_cgraph.png" border="0" usemap="#veil2_8c_ad03876d90cc6f64b46b87bdbe6dc7289_cgraph" alt=""/></div>
<map name="veil2_8c_ad03876d90cc6f64b46b87bdbe6dc7289_cgraph" id="veil2_8c_ad03876d90cc6f64b46b87bdbe6dc7289_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#ad0227b91fd8a98d84dc03bff37ea89f1" title="do_load_session_privs" alt="" coords="140,132,307,159"/>
<area shape="rect" id="node3" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="355,5,501,32"/>
<area shape="rect" id="node5" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="728,81,875,108"/>
<area shape="rect" id="node6" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="361,107,495,133"/>
<area shape="rect" id="node7" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="381,208,475,235"/>
<area shape="rect" id="node10" href="veil2_8c.html#a8427f8ff086c0cfde8433b48faf005b2" title="fetch_scope_privs" alt="" coords="359,157,497,184"/>
<area shape="rect" id="node12" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="369,259,487,285"/>
<area shape="rect" id="node4" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="551,5,678,32"/>
<area shape="rect" id="node8" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="555,208,675,235"/>
<area shape="rect" id="node9" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="744,208,859,235"/>
<area shape="rect" id="node11" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5" title="add_scope_privs" alt="" coords="549,132,680,159"/>
</map>
</div>

</div>
</div>
<a id="a22033ed27181d9b4943f2916394a546e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22033ed27181d9b4943f2916394a546e">&#9670;&nbsp;</a></span>textfromstr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static text* textfromstr </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a dynamically allocated text value as a copy of a C string.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>String to be copied</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Dynamically allocated (by palloc()) copy of in. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01009">1009</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a351e9c866a977deb2a28e07091adba0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a351e9c866a977deb2a28e07091adba0d">&#9670;&nbsp;</a></span>truncate_temp_tables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void truncate_temp_tables </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clear_context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Truncate the veil2_session_privileges and veil2_session_context temporary tables (actually we use deletion rather than truncation as it seems faster.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clear_context</td><td>Whether veil2_session_context should be cleared as well as the privileges temp tables. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00470">470</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a351e9c866a977deb2a28e07091adba0d_cgraph.png" border="0" usemap="#veil2_8c_a351e9c866a977deb2a28e07091adba0d_cgraph" alt=""/></div>
<map name="veil2_8c_a351e9c866a977deb2a28e07091adba0d_cgraph" id="veil2_8c_a351e9c866a977deb2a28e07091adba0d_cgraph">
<area shape="rect" id="node2" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="211,5,305,32"/>
<area shape="rect" id="node3" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="353,5,473,32"/>
<area shape="rect" id="node4" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="521,5,636,32"/>
</map>
</div>

</div>
</div>
<a id="a79c18f7c4ed4d0fc2aa31e942e3a194a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79c18f7c4ed4d0fc2aa31e942e3a194a">&#9670;&nbsp;</a></span>veil2_datapath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_datapath </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provide the path to where veil2 sql scripts should be stored on the server.</p>
<dl class="section return"><dt>Returns</dt><dd>Text value containing the path. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01037">1037</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a79c18f7c4ed4d0fc2aa31e942e3a194a_cgraph.png" border="0" usemap="#veil2_8c_a79c18f7c4ed4d0fc2aa31e942e3a194a_cgraph" alt=""/></div>
<map name="veil2_8c_a79c18f7c4ed4d0fc2aa31e942e3a194a_cgraph" id="veil2_8c_a79c18f7c4ed4d0fc2aa31e942e3a194a_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a22033ed27181d9b4943f2916394a546e" title="textfromstr" alt="" coords="168,5,257,32"/>
</map>
</div>

</div>
</div>
<a id="a66116a3513e9a99192202401cc5f394e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66116a3513e9a99192202401cc5f394e">&#9670;&nbsp;</a></span>veil2_docpath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_docpath </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provide the path to where documentation should be stored on the server.</p>
<dl class="section return"><dt>Returns</dt><dd>Text value containing the path. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01025">1025</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a66116a3513e9a99192202401cc5f394e_cgraph.png" border="0" usemap="#veil2_8c_a66116a3513e9a99192202401cc5f394e_cgraph" alt=""/></div>
<map name="veil2_8c_a66116a3513e9a99192202401cc5f394e_cgraph" id="veil2_8c_a66116a3513e9a99192202401cc5f394e_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a22033ed27181d9b4943f2916394a546e" title="textfromstr" alt="" coords="164,5,253,32"/>
</map>
</div>

</div>
</div>
<a id="a0f03a4c32bbac407d040e66fcb807e48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f03a4c32bbac407d040e66fcb807e48">&#9670;&nbsp;</a></span>veil2_i_have_global_priv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_global_priv </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_global_priv(priv) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, with global scope.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00669">669</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a0f03a4c32bbac407d040e66fcb807e48_cgraph.png" border="0" usemap="#veil2_8c_a0f03a4c32bbac407d040e66fcb807e48_cgraph" alt=""/></div>
<map name="veil2_8c_a0f03a4c32bbac407d040e66fcb807e48_cgraph" id="veil2_8c_a0f03a4c32bbac407d040e66fcb807e48_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="231,81,381,108"/>
<area shape="rect" id="node11" href="veil2_8c.html#ad03876d90cc6f64b46b87bdbe6dc7289" title="load_privs" alt="" coords="263,157,349,184"/>
<area shape="rect" id="node18" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="252,208,360,235"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="439,81,587,108"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="659,56,793,83"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="644,5,808,32"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="667,107,785,133"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="874,107,969,133"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="862,5,981,32"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="1048,107,1168,133"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1229,107,1344,133"/>
<area shape="rect" id="node12" href="veil2_8c.html#ad0227b91fd8a98d84dc03bff37ea89f1" title="do_load_session_privs" alt="" coords="429,157,596,184"/>
<area shape="rect" id="node13" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="653,208,799,235"/>
<area shape="rect" id="node15" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="1035,284,1181,311"/>
<area shape="rect" id="node16" href="veil2_8c.html#a8427f8ff086c0cfde8433b48faf005b2" title="fetch_scope_privs" alt="" coords="657,259,795,285"/>
<area shape="rect" id="node14" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="858,208,985,235"/>
<area shape="rect" id="node17" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5" title="add_scope_privs" alt="" coords="856,259,987,285"/>
<area shape="rect" id="node19" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="465,208,560,235"/>
</map>
</div>

</div>
</div>
<a id="abdf7a99cee51319e393a9d0d3a1e79ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdf7a99cee51319e393a9d0d3a1e79ef">&#9670;&nbsp;</a></span>veil2_i_have_personal_priv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_personal_priv </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_personal_priv(priv, accessor_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in their personal scope (ie for data pertaining to themselves).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">accessor_id</td><td>Integer id for a party from the record being checked.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege in the personal scope of the given accessor_id </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00699">699</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_abdf7a99cee51319e393a9d0d3a1e79ef_cgraph.png" border="0" usemap="#veil2_8c_abdf7a99cee51319e393a9d0d3a1e79ef_cgraph" alt=""/></div>
<map name="veil2_8c_abdf7a99cee51319e393a9d0d3a1e79ef_cgraph" id="veil2_8c_abdf7a99cee51319e393a9d0d3a1e79ef_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="248,81,399,108"/>
<area shape="rect" id="node11" href="veil2_8c.html#ad03876d90cc6f64b46b87bdbe6dc7289" title="load_privs" alt="" coords="280,157,367,184"/>
<area shape="rect" id="node18" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="269,208,377,235"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="456,81,604,108"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="676,56,811,83"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="661,5,825,32"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="684,107,803,133"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="891,107,986,133"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="879,5,998,32"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="1065,107,1185,133"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1247,107,1361,133"/>
<area shape="rect" id="node12" href="veil2_8c.html#ad0227b91fd8a98d84dc03bff37ea89f1" title="do_load_session_privs" alt="" coords="447,157,613,184"/>
<area shape="rect" id="node13" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="670,208,817,235"/>
<area shape="rect" id="node15" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="1052,284,1199,311"/>
<area shape="rect" id="node16" href="veil2_8c.html#a8427f8ff086c0cfde8433b48faf005b2" title="fetch_scope_privs" alt="" coords="675,259,812,285"/>
<area shape="rect" id="node14" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="875,208,1002,235"/>
<area shape="rect" id="node17" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5" title="add_scope_privs" alt="" coords="873,259,1004,285"/>
<area shape="rect" id="node19" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="483,208,577,235"/>
</map>
</div>

</div>
</div>
<a id="a1f3226ae495eaf76f2f1165026a7f0eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f3226ae495eaf76f2f1165026a7f0eb">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_scope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_scope </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_scope(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in a specific scope (<code>scope_type_id</code>, <code>scope_id</code>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege for the given scope_type_id and scope_id </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00731">731</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a1f3226ae495eaf76f2f1165026a7f0eb_cgraph.png" border="0" usemap="#veil2_8c_a1f3226ae495eaf76f2f1165026a7f0eb_cgraph" alt=""/></div>
<map name="veil2_8c_a1f3226ae495eaf76f2f1165026a7f0eb_cgraph" id="veil2_8c_a1f3226ae495eaf76f2f1165026a7f0eb_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="204,81,355,108"/>
<area shape="rect" id="node11" href="veil2_8c.html#ad03876d90cc6f64b46b87bdbe6dc7289" title="load_privs" alt="" coords="236,157,323,184"/>
<area shape="rect" id="node18" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="225,208,333,235"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="412,81,560,108"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="632,56,767,83"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="617,5,781,32"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="640,107,759,133"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="847,107,942,133"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="835,5,954,32"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="1021,107,1141,133"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1203,107,1317,133"/>
<area shape="rect" id="node12" href="veil2_8c.html#ad0227b91fd8a98d84dc03bff37ea89f1" title="do_load_session_privs" alt="" coords="403,157,569,184"/>
<area shape="rect" id="node13" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="626,208,773,235"/>
<area shape="rect" id="node15" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="1008,284,1155,311"/>
<area shape="rect" id="node16" href="veil2_8c.html#a8427f8ff086c0cfde8433b48faf005b2" title="fetch_scope_privs" alt="" coords="631,259,768,285"/>
<area shape="rect" id="node14" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="831,208,958,235"/>
<area shape="rect" id="node17" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5" title="add_scope_privs" alt="" coords="829,259,960,285"/>
<area shape="rect" id="node19" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="439,208,533,235"/>
</map>
</div>

</div>
</div>
<a id="af94dca10e6f14dc3fb20bbb288415fca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af94dca10e6f14dc3fb20bbb288415fca">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_scope_or_global()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_scope_or_global </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_scope_or_global(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in a specific scope (<code>scope_type_id</code>, <code>scope_id</code>), or in global scope.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege for the given scope_type_id and scope_id </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00764">764</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_af94dca10e6f14dc3fb20bbb288415fca_cgraph.png" border="0" usemap="#veil2_8c_af94dca10e6f14dc3fb20bbb288415fca_cgraph" alt=""/></div>
<map name="veil2_8c_af94dca10e6f14dc3fb20bbb288415fca_cgraph" id="veil2_8c_af94dca10e6f14dc3fb20bbb288415fca_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="204,81,355,108"/>
<area shape="rect" id="node11" href="veil2_8c.html#ad03876d90cc6f64b46b87bdbe6dc7289" title="load_privs" alt="" coords="236,157,323,184"/>
<area shape="rect" id="node18" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="225,208,333,235"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="412,81,560,108"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="632,56,767,83"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="617,5,781,32"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="640,107,759,133"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="847,107,942,133"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="835,5,954,32"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="1021,107,1141,133"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1203,107,1317,133"/>
<area shape="rect" id="node12" href="veil2_8c.html#ad0227b91fd8a98d84dc03bff37ea89f1" title="do_load_session_privs" alt="" coords="403,157,569,184"/>
<area shape="rect" id="node13" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="626,208,773,235"/>
<area shape="rect" id="node15" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="1008,284,1155,311"/>
<area shape="rect" id="node16" href="veil2_8c.html#a8427f8ff086c0cfde8433b48faf005b2" title="fetch_scope_privs" alt="" coords="631,259,768,285"/>
<area shape="rect" id="node14" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="831,208,958,235"/>
<area shape="rect" id="node17" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5" title="add_scope_privs" alt="" coords="829,259,960,285"/>
<area shape="rect" id="node19" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="439,208,533,235"/>
</map>
</div>

</div>
</div>
<a id="a4b25cd404b6882e64e0d484222ee8f93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b25cd404b6882e64e0d484222ee8f93">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_scope_or_superior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_scope_or_superior </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_scope_or_superior(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in the supplied scope or a superior one: <code>scope_type_id</code>, <code>scope_id</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege in the scope given by scope_type_id and scope_id or a supeior one. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00857">857</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a4b25cd404b6882e64e0d484222ee8f93_cgraph.png" border="0" usemap="#veil2_8c_a4b25cd404b6882e64e0d484222ee8f93_cgraph" alt=""/></div>
<map name="veil2_8c_a4b25cd404b6882e64e0d484222ee8f93_cgraph" id="veil2_8c_a4b25cd404b6882e64e0d484222ee8f93_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="204,51,355,77"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="632,25,767,52"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="617,76,781,103"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="640,127,759,153"/>
<area shape="rect" id="node11" href="veil2_8c.html#ad03876d90cc6f64b46b87bdbe6dc7289" title="load_privs" alt="" coords="236,203,323,229"/>
<area shape="rect" id="node18" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="225,253,333,280"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="412,51,560,77"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="847,152,942,179"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="835,76,954,103"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="1021,152,1141,179"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1203,152,1317,179"/>
<area shape="rect" id="node12" href="veil2_8c.html#ad0227b91fd8a98d84dc03bff37ea89f1" title="do_load_session_privs" alt="" coords="403,203,569,229"/>
<area shape="rect" id="node13" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="626,228,773,255"/>
<area shape="rect" id="node15" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="1008,304,1155,331"/>
<area shape="rect" id="node16" href="veil2_8c.html#a8427f8ff086c0cfde8433b48faf005b2" title="fetch_scope_privs" alt="" coords="631,279,768,305"/>
<area shape="rect" id="node14" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="831,228,958,255"/>
<area shape="rect" id="node17" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5" title="add_scope_privs" alt="" coords="829,279,960,305"/>
<area shape="rect" id="node19" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="439,253,533,280"/>
</map>
</div>

</div>
</div>
<a id="a1648915ba36e9f03b3ace8c43ad2fb9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1648915ba36e9f03b3ace8c43ad2fb9f">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_scope_or_superior_or_global()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_scope_or_superior_or_global </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_scope_or_superior_or_global(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in global_scope, or the supplied scope, or a superior one: <code>scope_type_id</code>, <code>scope_id</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege in the scope given by scope_type_id and scope_id or a supeior one or global scope. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00924">924</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a1648915ba36e9f03b3ace8c43ad2fb9f_cgraph.png" border="0" usemap="#veil2_8c_a1648915ba36e9f03b3ace8c43ad2fb9f_cgraph" alt=""/></div>
<map name="veil2_8c_a1648915ba36e9f03b3ace8c43ad2fb9f_cgraph" id="veil2_8c_a1648915ba36e9f03b3ace8c43ad2fb9f_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="223,49,373,76"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="651,24,785,50"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="636,74,800,101"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="659,125,777,152"/>
<area shape="rect" id="node11" href="veil2_8c.html#ad03876d90cc6f64b46b87bdbe6dc7289" title="load_privs" alt="" coords="255,201,341,228"/>
<area shape="rect" id="node18" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="244,252,352,278"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="431,49,579,76"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="866,150,961,177"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="854,74,973,101"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="1040,150,1160,177"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1221,150,1336,177"/>
<area shape="rect" id="node12" href="veil2_8c.html#ad0227b91fd8a98d84dc03bff37ea89f1" title="do_load_session_privs" alt="" coords="421,201,588,228"/>
<area shape="rect" id="node13" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="645,226,791,253"/>
<area shape="rect" id="node15" href="veil2_8c.html#aabe26dc105921f8fdf5304f8cb51fccb" title="extendSessionPrivs" alt="" coords="1027,302,1173,329"/>
<area shape="rect" id="node16" href="veil2_8c.html#a8427f8ff086c0cfde8433b48faf005b2" title="fetch_scope_privs" alt="" coords="649,277,787,304"/>
<area shape="rect" id="node14" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="850,226,977,253"/>
<area shape="rect" id="node17" href="veil2_8c.html#a552c63ade183ba790a1fc1105117c6b5" title="add_scope_privs" alt="" coords="848,277,979,304"/>
<area shape="rect" id="node19" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="457,252,552,278"/>
</map>
</div>

</div>
</div>
<a id="ab26e0230a290a97425e5fd7c420737b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab26e0230a290a97425e5fd7c420737b6">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_superior_scope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_superior_scope </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_superior_scope(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in a superior scope to that supplied: <code>scope_type_id</code>, <code>scope_id</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege in a scope superior to that given by scope_type_id and scope_id </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00801">801</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_ab26e0230a290a97425e5fd7c420737b6_cgraph.png" border="0" usemap="#veil2_8c_ab26e0230a290a97425e5fd7c420737b6_cgraph" alt=""/></div>
<map name="veil2_8c_ab26e0230a290a97425e5fd7c420737b6_cgraph" id="veil2_8c_ab26e0230a290a97425e5fd7c420737b6_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="204,43,355,69"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="613,5,748,32"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="599,81,763,108"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="621,132,740,159"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="403,43,551,69"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="823,56,917,83"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="811,107,929,133"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="977,56,1097,83"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1145,56,1260,83"/>
</map>
</div>

</div>
</div>
<a id="aa978d6e0212eb0edf5436a07a4bec88d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa978d6e0212eb0edf5436a07a4bec88d">&#9670;&nbsp;</a></span>veil2_reset_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_reset_session </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.reset_session() returns void</code></p>
<p>Resets a postgres session prior to the recording of session privilege information. This ensures that the Veil2 temporary tables, on which our security depends, exist and have not been tamperered with. Unless this function succeeds, the privilege testing functions <a class="el" href="veil2_8c.html#a0f03a4c32bbac407d040e66fcb807e48">veil2_i_have_global_priv()</a>, <a class="el" href="veil2_8c.html#abdf7a99cee51319e393a9d0d3a1e79ef">veil2_i_have_personal_priv()</a>, <a class="el" href="veil2_8c.html#a1f3226ae495eaf76f2f1165026a7f0eb">veil2_i_have_priv_in_scope()</a> and <a class="el" href="veil2_8c.html#ab26e0230a290a97425e5fd7c420737b6">veil2_i_have_priv_in_superior_scope()</a> will always return false.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00588">588</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_aa978d6e0212eb0edf5436a07a4bec88d_cgraph.png" border="0" usemap="#veil2_8c_aa978d6e0212eb0edf5436a07a4bec88d_cgraph" alt=""/></div>
<map name="veil2_8c_aa978d6e0212eb0edf5436a07a4bec88d_cgraph" id="veil2_8c_aa978d6e0212eb0edf5436a07a4bec88d_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="200,5,347,32"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="206,56,341,83"/>
<area shape="rect" id="node5" href="veil2_8c.html#af7ae936fa571fecaac89d8adee322ae6" title="do_reset_session" alt="" coords="206,107,341,133"/>
<area shape="rect" id="node12" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="214,157,333,184"/>
<area shape="rect" id="node3" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="410,5,537,32"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="600,157,695,184"/>
<area shape="rect" id="node9" href="veil2_8c.html#a9267b3a3291b582296685bdc3dccfa1e" title="fetch_2ints" alt="" coords="428,107,519,133"/>
<area shape="rect" id="node10" href="veil2_8c.html#a45a90a5d613d0f79e8e18adfc0abdd66" title="create_temp_tables" alt="" coords="400,157,547,184"/>
<area shape="rect" id="node11" href="veil2_8c.html#a351e9c866a977deb2a28e07091adba0d" title="truncate_temp_tables" alt="" coords="395,208,552,235"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="743,157,863,184"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="911,157,1025,184"/>
</map>
</div>

</div>
</div>
<a id="ab9a3b057ba1dea0f0db728f321fb768d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9a3b057ba1dea0f0db728f321fb768d">&#9670;&nbsp;</a></span>veil2_reset_session_privs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_reset_session_privs </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.reset_session_privs() returns void</code></p>
<p>Clears the temp table and cached privileges for a postgres session and reloads them.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00609">609</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_ab9a3b057ba1dea0f0db728f321fb768d_cgraph.png" border="0" usemap="#veil2_8c_ab9a3b057ba1dea0f0db728f321fb768d_cgraph" alt=""/></div>
<map name="veil2_8c_ab9a3b057ba1dea0f0db728f321fb768d_cgraph" id="veil2_8c_ab9a3b057ba1dea0f0db728f321fb768d_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a3cc456848a9f63f74dfe80326e3f17a2" title="clear_session_privs" alt="" coords="200,5,347,32"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="206,56,341,83"/>
<area shape="rect" id="node5" href="veil2_8c.html#af7ae936fa571fecaac89d8adee322ae6" title="do_reset_session" alt="" coords="206,107,341,133"/>
<area shape="rect" id="node12" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="214,157,333,184"/>
<area shape="rect" id="node3" href="veil2_8c.html#ab6708652d0e229189e124f02a78964d3" title="freeContextPrivs" alt="" coords="410,5,537,32"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="600,157,695,184"/>
<area shape="rect" id="node9" href="veil2_8c.html#a9267b3a3291b582296685bdc3dccfa1e" title="fetch_2ints" alt="" coords="428,107,519,133"/>
<area shape="rect" id="node10" href="veil2_8c.html#a45a90a5d613d0f79e8e18adfc0abdd66" title="create_temp_tables" alt="" coords="400,157,547,184"/>
<area shape="rect" id="node11" href="veil2_8c.html#a351e9c866a977deb2a28e07091adba0d" title="truncate_temp_tables" alt="" coords="395,208,552,235"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="743,157,863,184"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="911,157,1025,184"/>
</map>
</div>

</div>
</div>
<a id="a6abf74250aa0970432b45b8146643e66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6abf74250aa0970432b45b8146643e66">&#9670;&nbsp;</a></span>veil2_result_counts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_result_counts </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of times one of the i_have_privilege_xxxx() functions has returned false and true.</p>
<dl class="section return"><dt>Returns</dt><dd>Record: false_count, true_count </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00980">980</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="ab1c1816e2ef1b38fdfc3abf503d3fc50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1c1816e2ef1b38fdfc3abf503d3fc50">&#9670;&nbsp;</a></span>veil2_session_ready()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_session_ready </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code><a class="el" href="veil2_8c.html#ab1c1816e2ef1b38fdfc3abf503d3fc50">veil2_session_ready()</a> returns bool</code> Predicate to indicate whether the current session has been properly initialized by <a class="el" href="veil2_8c.html#aa978d6e0212eb0edf5436a07a4bec88d">veil2_reset_session()</a>. It tests the static variable <a class="el" href="veil2_8c.html#a9206d7502b250a49f4279f788cd19c03">session_ready</a>.</p>
<dl class="section return"><dt>Returns</dt><dd><code>bool</code> true if this session has been set up. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00496">496</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a7eabb8210c058af3c045a215ee77b425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eabb8210c058af3c045a215ee77b425">&#9670;&nbsp;</a></span>veil2_true()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_true </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.true(params) returns bool</code></p>
<p>Always return true, regardless of parameters. This is used to determine the minimum possible overhead for a privilege testing predicate, for performance measurements.</p>
<dl class="section return"><dt>Returns</dt><dd>boolean true </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00630">630</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2997ca01e0a570ccaaf0b974b39bf7b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2997ca01e0a570ccaaf0b974b39bf7b6">&#9670;&nbsp;</a></span>result_counts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int result_counts[] = {0, 0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Used to record counts of false and true results from the i_have_priv_xxx() functions. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00067">67</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a35e0fd1762207cf7d5bf56ca50279232"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35e0fd1762207cf7d5bf56ca50279232">&#9670;&nbsp;</a></span>session_privs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSessionPrivs.html">SessionPrivs</a>* session_privs = ((void *) 0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The <a class="el" href="structSessionPrivs.html">SessionPrivs</a> object for this session. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00096">96</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="aec6a2cdc6993e99d274ad67ebc5b85dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec6a2cdc6993e99d274ad67ebc5b85dc">&#9670;&nbsp;</a></span>session_privs_loaded</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool session_privs_loaded = ((bool) 0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether we have loaded our session's <a class="el" href="structContextPrivs.html">ContextPrivs</a> into session memory. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00101">101</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a9206d7502b250a49f4279f788cd19c03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9206d7502b250a49f4279f788cd19c03">&#9670;&nbsp;</a></span>session_ready</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool session_ready = ((bool) 0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Used to record whether the current session's temporary tables have been properly initialised using <a class="el" href="veil2_8c.html#aa978d6e0212eb0edf5436a07a4bec88d">veil2_reset_session()</a>. If not the privilege testing functions <a class="el" href="veil2_8c.html#a0f03a4c32bbac407d040e66fcb807e48">veil2_i_have_global_priv()</a>, <a class="el" href="veil2_8c.html#abdf7a99cee51319e393a9d0d3a1e79ef">veil2_i_have_personal_priv()</a>, <a class="el" href="veil2_8c.html#a1f3226ae495eaf76f2f1165026a7f0eb">veil2_i_have_priv_in_scope()</a> and <a class="el" href="veil2_8c.html#ab26e0230a290a97425e5fd7c420737b6">veil2_i_have_priv_in_superior_scope()</a> will always return false. If you need to implement your own pl/pgsql base privilege testing function, it should call veil2_session_reeady() to ensure that privileges have been correctly set up.</p>
<p>The primary reason for this variable to exist is to ensure that a user cannot trick the privileges functions by creating their own session_privileges table. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00060">60</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="veil2_8c.html">veil2.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
