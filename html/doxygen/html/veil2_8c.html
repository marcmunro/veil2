<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Veil2: src/veil2.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Veil2
   </div>
   <div id="projectbrief">Postgres extension for VPD implementations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('veil2_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">veil2.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides callable veil2 functions. These are written in C for performance and to ensure that they cannot be easily subverted.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;postgres.h&quot;</code><br />
<code>#include &quot;funcapi.h&quot;</code><br />
<code>#include &quot;catalog/pg_type.h&quot;</code><br />
<code>#include &quot;access/xact.h&quot;</code><br />
<code>#include &quot;executor/spi.h&quot;</code><br />
<code>#include &quot;access/htup_details.h&quot;</code><br />
<code>#include &quot;utils/builtins.h&quot;</code><br />
<code>#include &quot;<a class="el" href="veil2_8h_source.html">veil2.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for veil2.c:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c__incl.png" border="0" usemap="#src_2veil2_8c" alt=""/></div>
<map name="src_2veil2_8c" id="src_2veil2_8c">
<area shape="rect" id="node11" href="veil2_8h.html" title="Main header file for veil2. " alt="" coords="1334,95,1397,121"/>
<area shape="rect" id="node13" href="veil2__version_8h.html" title="Provide build&#45;dependant definitions. " alt="" coords="1385,191,1501,218"/>
</map>
</div>
</div>
<p><a href="veil2_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structContextRolePrivs.html">ContextRolePrivs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSessionRolePrivs.html">SessionRolePrivs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSessionContext.html">SessionContext</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a70b0583241093e12b08f1c11c6b03e68"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a70b0583241093e12b08f1c11c6b03e68">CONTEXT_ROLEPRIVS_INCREMENT</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a70b0583241093e12b08f1c11c6b03e68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0938115cf26600783d372e93d07b6fc9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a0938115cf26600783d372e93d07b6fc9">CONTEXT_ROLEPRIVS_SIZE</a>(elems)</td></tr>
<tr class="separator:a0938115cf26600783d372e93d07b6fc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a19c7f5d2df4527ab984de57559ba783e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e">findContext</a> (int *p_idx, int scope_type, int scope)</td></tr>
<tr class="separator:a19c7f5d2df4527ab984de57559ba783e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ca237d772c5c3cdaf9aaa117d11fbbb"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb">checkContext</a> (int *p_idx, int scope_type, int scope, int priv)</td></tr>
<tr class="separator:a1ca237d772c5c3cdaf9aaa117d11fbbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bb26c76b5955baf572734ae5b6b5c4a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a6bb26c76b5955baf572734ae5b6b5c4a">freeContextRolePrivs</a> (<a class="el" href="structContextRolePrivs.html">ContextRolePrivs</a> *cp)</td></tr>
<tr class="separator:a6bb26c76b5955baf572734ae5b6b5c4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3d863c7368ccb8b02f6b039611ed26e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ac3d863c7368ccb8b02f6b039611ed26e">clear_session_roleprivs</a> ()</td></tr>
<tr class="separator:ac3d863c7368ccb8b02f6b039611ed26e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ffb1779a47185e6b824feed5a3a8ece"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSessionRolePrivs.html">SessionRolePrivs</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a7ffb1779a47185e6b824feed5a3a8ece">extendSessionRolePrivs</a> (<a class="el" href="structSessionRolePrivs.html">SessionRolePrivs</a> *<a class="el" href="veil2_8c.html#a3107d158c1cf2a3ed43023e7e2deb037">session_roleprivs</a>)</td></tr>
<tr class="separator:a7ffb1779a47185e6b824feed5a3a8ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37546e787f645707efd4fbf7543af277"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a37546e787f645707efd4fbf7543af277">add_scope_roleprivs</a> (int scope_type, int scope, Bitmap *roles, Bitmap *privs)</td></tr>
<tr class="separator:a37546e787f645707efd4fbf7543af277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0816bda9c352d3b1abfe91e5ce4032fb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a0816bda9c352d3b1abfe91e5ce4032fb">update_scope_roleprivs</a> (int scope_type, int scope, Bitmap *roles, Bitmap *privs)</td></tr>
<tr class="separator:a0816bda9c352d3b1abfe91e5ce4032fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6b01654a9686d26fa3f2ee2533a619"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619">error_if_no_session</a> ()</td></tr>
<tr class="separator:a6d6b01654a9686d26fa3f2ee2533a619"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9267b3a3291b582296685bdc3dccfa1e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a9267b3a3291b582296685bdc3dccfa1e">fetch_2ints</a> (HeapTuple tuple, TupleDesc tupdesc, void *p_result)</td></tr>
<tr class="separator:a9267b3a3291b582296685bdc3dccfa1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45a90a5d613d0f79e8e18adfc0abdd66"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a45a90a5d613d0f79e8e18adfc0abdd66">create_temp_tables</a> ()</td></tr>
<tr class="separator:a45a90a5d613d0f79e8e18adfc0abdd66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7ae936fa571fecaac89d8adee322ae6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#af7ae936fa571fecaac89d8adee322ae6">do_reset_session</a> (bool clear_context)</td></tr>
<tr class="separator:af7ae936fa571fecaac89d8adee322ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c1816e2ef1b38fdfc3abf503d3fc50"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ab1c1816e2ef1b38fdfc3abf503d3fc50">veil2_session_ready</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:ab1c1816e2ef1b38fdfc3abf503d3fc50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa978d6e0212eb0edf5436a07a4bec88d"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#aa978d6e0212eb0edf5436a07a4bec88d">veil2_reset_session</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:aa978d6e0212eb0edf5436a07a4bec88d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9a3b057ba1dea0f0db728f321fb768d"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ab9a3b057ba1dea0f0db728f321fb768d">veil2_reset_session_privs</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:ab9a3b057ba1dea0f0db728f321fb768d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac488f8c8283ea0f8ef4d570c7051cfe8"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ac488f8c8283ea0f8ef4d570c7051cfe8">veil2_session_context</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:ac488f8c8283ea0f8ef4d570c7051cfe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a950003d33ac24802b9bdb2839b3de0a7"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a950003d33ac24802b9bdb2839b3de0a7">veil2_session_privileges</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a950003d33ac24802b9bdb2839b3de0a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a077cedf7abdcaaca296bb6d4d164b20d"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a077cedf7abdcaaca296bb6d4d164b20d">veil2_add_session_privileges</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a077cedf7abdcaaca296bb6d4d164b20d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10139c4202e09809de2c4f65262a3923"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a10139c4202e09809de2c4f65262a3923">veil2_update_session_privileges</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a10139c4202e09809de2c4f65262a3923"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eabb8210c058af3c045a215ee77b425"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a7eabb8210c058af3c045a215ee77b425">veil2_true</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a7eabb8210c058af3c045a215ee77b425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdfc74e12e705f110f1f6719ee33c7ea"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea">checkSessionReady</a> ()</td></tr>
<tr class="separator:abdfc74e12e705f110f1f6719ee33c7ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f03a4c32bbac407d040e66fcb807e48"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a0f03a4c32bbac407d040e66fcb807e48">veil2_i_have_global_priv</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a0f03a4c32bbac407d040e66fcb807e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdf7a99cee51319e393a9d0d3a1e79ef"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#abdf7a99cee51319e393a9d0d3a1e79ef">veil2_i_have_personal_priv</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:abdf7a99cee51319e393a9d0d3a1e79ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f3226ae495eaf76f2f1165026a7f0eb"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a1f3226ae495eaf76f2f1165026a7f0eb">veil2_i_have_priv_in_scope</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a1f3226ae495eaf76f2f1165026a7f0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af94dca10e6f14dc3fb20bbb288415fca"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#af94dca10e6f14dc3fb20bbb288415fca">veil2_i_have_priv_in_scope_or_global</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:af94dca10e6f14dc3fb20bbb288415fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab26e0230a290a97425e5fd7c420737b6"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#ab26e0230a290a97425e5fd7c420737b6">veil2_i_have_priv_in_superior_scope</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:ab26e0230a290a97425e5fd7c420737b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b25cd404b6882e64e0d484222ee8f93"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a4b25cd404b6882e64e0d484222ee8f93">veil2_i_have_priv_in_scope_or_superior</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a4b25cd404b6882e64e0d484222ee8f93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1648915ba36e9f03b3ace8c43ad2fb9f"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a1648915ba36e9f03b3ace8c43ad2fb9f">veil2_i_have_priv_in_scope_or_superior_or_global</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a1648915ba36e9f03b3ace8c43ad2fb9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6abf74250aa0970432b45b8146643e66"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a6abf74250aa0970432b45b8146643e66">veil2_result_counts</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a6abf74250aa0970432b45b8146643e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22033ed27181d9b4943f2916394a546e"><td class="memItemLeft" align="right" valign="top">static text *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a22033ed27181d9b4943f2916394a546e">textfromstr</a> (char *in)</td></tr>
<tr class="separator:a22033ed27181d9b4943f2916394a546e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66116a3513e9a99192202401cc5f394e"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a66116a3513e9a99192202401cc5f394e">veil2_docpath</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a66116a3513e9a99192202401cc5f394e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c18f7c4ed4d0fc2aa31e942e3a194a"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a79c18f7c4ed4d0fc2aa31e942e3a194a">veil2_datapath</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:a79c18f7c4ed4d0fc2aa31e942e3a194a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe5b90a80701c7d22ff03c8fdf76e196"><td class="memItemLeft" align="right" valign="top">Datum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#afe5b90a80701c7d22ff03c8fdf76e196">veil2_version</a> (FunctionCallInfo fcinfo)</td></tr>
<tr class="separator:afe5b90a80701c7d22ff03c8fdf76e196"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9206d7502b250a49f4279f788cd19c03"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a9206d7502b250a49f4279f788cd19c03">session_ready</a> = ((bool) 0)</td></tr>
<tr class="separator:a9206d7502b250a49f4279f788cd19c03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2997ca01e0a570ccaaf0b974b39bf7b6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a2997ca01e0a570ccaaf0b974b39bf7b6">result_counts</a> [] = {0, 0}</td></tr>
<tr class="separator:a2997ca01e0a570ccaaf0b974b39bf7b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3107d158c1cf2a3ed43023e7e2deb037"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSessionRolePrivs.html">SessionRolePrivs</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a3107d158c1cf2a3ed43023e7e2deb037">session_roleprivs</a> = ((void *) 0)</td></tr>
<tr class="separator:a3107d158c1cf2a3ed43023e7e2deb037"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dfe0446477a1237ba5c84d63d32dd3f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a5dfe0446477a1237ba5c84d63d32dd3f">session_roleprivs_loaded</a> = ((bool) 0)</td></tr>
<tr class="separator:a5dfe0446477a1237ba5c84d63d32dd3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3036f6e034e902642fa98e4ef42ce25a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structSessionContext.html">SessionContext</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="veil2_8c.html#a3036f6e034e902642fa98e4ef42ce25a">session_context</a></td></tr>
<tr class="separator:a3036f6e034e902642fa98e4ef42ce25a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides callable veil2 functions. These are written in C for performance and to ensure that they cannot be easily subverted. </p>
<div class="fragment"><div class="line">Author:       Marc Munro</div><div class="line">Copyright (c) 2020,2021 Marc Munro</div><div class="line">License:      GPL V3</div></div><!-- fragment --> 
<p class="definition">Definition in file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a70b0583241093e12b08f1c11c6b03e68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70b0583241093e12b08f1c11c6b03e68">&#9670;&nbsp;</a></span>CONTEXT_ROLEPRIVS_INCREMENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTEXT_ROLEPRIVS_INCREMENT&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How many ContextPrivs entries a SessionPrivs structure will be created with or extended by. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00270">270</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a0938115cf26600783d372e93d07b6fc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0938115cf26600783d372e93d07b6fc9">&#9670;&nbsp;</a></span>CONTEXT_ROLEPRIVS_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTEXT_ROLEPRIVS_SIZE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">elems</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(                   \</div><div class="line">    sizeof(<a class="code" href="structSessionRolePrivs.html">SessionRolePrivs</a>) +                          \</div><div class="line">    (<span class="keyword">sizeof</span>(<a class="code" href="structContextRolePrivs.html">ContextRolePrivs</a>) *                         \</div><div class="line">     (elems + <a class="code" href="veil2_8c.html#a70b0583241093e12b08f1c11c6b03e68">CONTEXT_ROLEPRIVS_INCREMENT</a>)))</div><div class="ttc" id="veil2_8c_html_a70b0583241093e12b08f1c11c6b03e68"><div class="ttname"><a href="veil2_8c.html#a70b0583241093e12b08f1c11c6b03e68">CONTEXT_ROLEPRIVS_INCREMENT</a></div><div class="ttdeci">#define CONTEXT_ROLEPRIVS_INCREMENT</div><div class="ttdef"><b>Definition:</b> <a href="veil2_8c_source.html#l00270">veil2.c:270</a></div></div>
<div class="ttc" id="structSessionRolePrivs_html"><div class="ttname"><a href="structSessionRolePrivs.html">SessionRolePrivs</a></div><div class="ttdef"><b>Definition:</b> <a href="veil2_8c_source.html#l00091">veil2.c:91</a></div></div>
<div class="ttc" id="structContextRolePrivs_html"><div class="ttname"><a href="structContextRolePrivs.html">ContextRolePrivs</a></div><div class="ttdef"><b>Definition:</b> <a href="veil2_8c_source.html#l00081">veil2.c:81</a></div></div>
</div><!-- fragment --><p>Provide the size that we want our <a class="el" href="structSessionRolePrivs.html">SessionRolePrivs</a> structure to be.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">elems</td><td>the number of <a class="el" href="structContextRolePrivs.html">ContextRolePrivs</a> entries already in place. This will be increased by CONTEXT_ROLEPRIVS_INCREMENT. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00277">277</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a37546e787f645707efd4fbf7543af277"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37546e787f645707efd4fbf7543af277">&#9670;&nbsp;</a></span>add_scope_roleprivs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_scope_roleprivs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bitmap *&#160;</td>
          <td class="paramname"><em>roles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bitmap *&#160;</td>
          <td class="paramname"><em>privs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add a ContextPrivs entry to <a class="el" href="veil2_8c.html#a3107d158c1cf2a3ed43023e7e2deb037">session_roleprivs</a>, from the parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scope_type</td><td>The scope_type for the new entry </td></tr>
    <tr><td class="paramname">scope</td><td>The scope scope for the new entry </td></tr>
    <tr><td class="paramname">roles</td><td>The roles Bitmap for the new entry </td></tr>
    <tr><td class="paramname">privs</td><td>The privileges Bitmap for the new entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00329">329</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a37546e787f645707efd4fbf7543af277_cgraph.png" border="0" usemap="#veil2_8c_a37546e787f645707efd4fbf7543af277_cgraph" alt=""/></div>
<map name="veil2_8c_a37546e787f645707efd4fbf7543af277_cgraph" id="veil2_8c_a37546e787f645707efd4fbf7543af277_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a7ffb1779a47185e6b824feed5a3a8ece" title="extendSessionRolePrivs" alt="" coords="208,5,383,32"/>
</map>
</div>

</div>
</div>
<a id="a1ca237d772c5c3cdaf9aaa117d11fbbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ca237d772c5c3cdaf9aaa117d11fbbb">&#9670;&nbsp;</a></span>checkContext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool checkContext </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>p_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>priv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wrapper for <a class="el" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e">findContext()</a> that finds the context and checks for a privilege in a single operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_idx</td><td>Pointer to a cached index value for the entry in the <a class="el" href="veil2_8c.html#a3107d158c1cf2a3ed43023e7e2deb037">session_roleprivs</a>-&gt;active_contexts that the search should start from. This allows the caller to cache the last returned index in the hope that they will be looking for the same entry next time. If no cached value exists, the caller should provide -1. The index of the found ContextPrivs entry will be returned through this, or -1 if no context can be found. </td></tr>
    <tr><td class="paramname">scope_type</td><td>The scope_type_id of the ContextPrivs entry we are looking for. </td></tr>
    <tr><td class="paramname">scope</td><td>The scope_id of the ContextPrivs entry we are looking for. </td></tr>
    <tr><td class="paramname">priv</td><td>The privilege to test for.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>false if no context can be found, otherwise true if the user has priv in the supplied scope. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00219">219</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a1ca237d772c5c3cdaf9aaa117d11fbbb_cgraph.png" border="0" usemap="#veil2_8c_a1ca237d772c5c3cdaf9aaa117d11fbbb_cgraph" alt=""/></div>
<map name="veil2_8c_a1ca237d772c5c3cdaf9aaa117d11fbbb_cgraph" id="veil2_8c_a1ca237d772c5c3cdaf9aaa117d11fbbb_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="161,5,256,32"/>
</map>
</div>

</div>
</div>
<a id="abdfc74e12e705f110f1f6719ee33c7ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdfc74e12e705f110f1f6719ee33c7ea">&#9670;&nbsp;</a></span>checkSessionReady()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool checkSessionReady </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check whether a session has been properly initialized. If not, and we are supposed to fail in such a situation, fail with an appropriate error message. Otherwise return true if the session is ready to go.</p>
<dl class="section return"><dt>Returns</dt><dd>boolean True if our session has been properly initialized. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00810">810</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_abdfc74e12e705f110f1f6719ee33c7ea_cgraph.png" border="0" usemap="#veil2_8c_abdfc74e12e705f110f1f6719ee33c7ea_cgraph" alt=""/></div>
<map name="veil2_8c_abdfc74e12e705f110f1f6719ee33c7ea_cgraph" id="veil2_8c_abdfc74e12e705f110f1f6719ee33c7ea_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="204,56,352,83"/>
<area shape="rect" id="node3" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="415,5,549,32"/>
<area shape="rect" id="node4" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="400,56,564,83"/>
<area shape="rect" id="node9" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="423,107,541,133"/>
<area shape="rect" id="node5" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="624,31,719,57"/>
<area shape="rect" id="node8" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="612,81,731,108"/>
<area shape="rect" id="node6" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="779,31,899,57"/>
<area shape="rect" id="node7" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="947,31,1061,57"/>
</map>
</div>

</div>
</div>
<a id="ac3d863c7368ccb8b02f6b039611ed26e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3d863c7368ccb8b02f6b039611ed26e">&#9670;&nbsp;</a></span>clear_session_roleprivs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void clear_session_roleprivs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clear all <a class="el" href="structContextRolePrivs.html">ContextRolePrivs</a> entries in session_roleprivs. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00250">250</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_ac3d863c7368ccb8b02f6b039611ed26e_cgraph.png" border="0" usemap="#veil2_8c_ac3d863c7368ccb8b02f6b039611ed26e_cgraph" alt=""/></div>
<map name="veil2_8c_ac3d863c7368ccb8b02f6b039611ed26e_cgraph" id="veil2_8c_ac3d863c7368ccb8b02f6b039611ed26e_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a6bb26c76b5955baf572734ae5b6b5c4a" title="freeContextRolePrivs" alt="" coords="224,5,380,32"/>
</map>
</div>

</div>
</div>
<a id="a45a90a5d613d0f79e8e18adfc0abdd66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45a90a5d613d0f79e8e18adfc0abdd66">&#9670;&nbsp;</a></span>create_temp_tables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void create_temp_tables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a temporary table used for handling privileges in become_user. Originally, more temp tables were used but these have been replaced by in memory structures for performance and security. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00445">445</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a45a90a5d613d0f79e8e18adfc0abdd66_cgraph.png" border="0" usemap="#veil2_8c_a45a90a5d613d0f79e8e18adfc0abdd66_cgraph" alt=""/></div>
<map name="veil2_8c_a45a90a5d613d0f79e8e18adfc0abdd66_cgraph" id="veil2_8c_a45a90a5d613d0f79e8e18adfc0abdd66_cgraph">
<area shape="rect" id="node2" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="200,5,295,32"/>
<area shape="rect" id="node3" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="343,5,463,32"/>
<area shape="rect" id="node4" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="511,5,625,32"/>
</map>
</div>

</div>
</div>
<a id="af7ae936fa571fecaac89d8adee322ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7ae936fa571fecaac89d8adee322ae6">&#9670;&nbsp;</a></span>do_reset_session()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void do_reset_session </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clear_context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Does the database donkey-work for <a class="el" href="veil2_8c.html#aa978d6e0212eb0edf5436a07a4bec88d">veil2_reset_session()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clear_context</td><td>Whether veil2_session_context should be cleared as well as the privileges temp tables. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00463">463</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_af7ae936fa571fecaac89d8adee322ae6_cgraph.png" border="0" usemap="#veil2_8c_af7ae936fa571fecaac89d8adee322ae6_cgraph" alt=""/></div>
<map name="veil2_8c_af7ae936fa571fecaac89d8adee322ae6_cgraph" id="veil2_8c_af7ae936fa571fecaac89d8adee322ae6_cgraph">
<area shape="rect" id="node2" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="437,26,532,52"/>
<area shape="rect" id="node5" href="veil2_8c.html#a9267b3a3291b582296685bdc3dccfa1e" title="fetch_2ints" alt="" coords="228,26,319,52"/>
<area shape="rect" id="node6" href="veil2_8c.html#a45a90a5d613d0f79e8e18adfc0abdd66" title="create_temp_tables" alt="" coords="200,76,347,103"/>
<area shape="rect" id="node7" href="veil2_8c.html#ac3d863c7368ccb8b02f6b039611ed26e" title="clear_session_roleprivs" alt="" coords="188,127,359,154"/>
<area shape="rect" id="node3" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="611,26,731,52"/>
<area shape="rect" id="node4" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="779,26,893,52"/>
<area shape="rect" id="node8" href="veil2_8c.html#a6bb26c76b5955baf572734ae5b6b5c4a" title="freeContextRolePrivs" alt="" coords="407,127,563,154"/>
</map>
</div>

</div>
</div>
<a id="a6d6b01654a9686d26fa3f2ee2533a619"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6b01654a9686d26fa3f2ee2533a619">&#9670;&nbsp;</a></span>error_if_no_session()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool error_if_no_session </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Predicate to indicate whether to raise an error if a privilege test function has been called prior to a session being established. If not, the privilege testing function should return false. The determination of whether to error or return false is based on the value of the veil2.system_parameter 'error on uninitialized session' at the time that the database session is established.</p>
<dl class="section return"><dt>Returns</dt><dd>boolean, whether or not to raise an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00395">395</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a6d6b01654a9686d26fa3f2ee2533a619_cgraph.png" border="0" usemap="#veil2_8c_a6d6b01654a9686d26fa3f2ee2533a619_cgraph" alt=""/></div>
<map name="veil2_8c_a6d6b01654a9686d26fa3f2ee2533a619_cgraph" id="veil2_8c_a6d6b01654a9686d26fa3f2ee2533a619_cgraph">
<area shape="rect" id="node2" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="216,5,351,32"/>
<area shape="rect" id="node3" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="201,56,365,83"/>
<area shape="rect" id="node8" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="224,107,343,133"/>
<area shape="rect" id="node4" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="425,31,520,57"/>
<area shape="rect" id="node7" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="413,81,532,108"/>
<area shape="rect" id="node5" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="580,31,700,57"/>
<area shape="rect" id="node6" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="748,31,863,57"/>
</map>
</div>

</div>
</div>
<a id="a7ffb1779a47185e6b824feed5a3a8ece"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ffb1779a47185e6b824feed5a3a8ece">&#9670;&nbsp;</a></span>extendSessionRolePrivs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structSessionRolePrivs.html">SessionRolePrivs</a>* extendSessionRolePrivs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSessionRolePrivs.html">SessionRolePrivs</a> *&#160;</td>
          <td class="paramname"><em>session_roleprivs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00290">290</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a9267b3a3291b582296685bdc3dccfa1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9267b3a3291b582296685bdc3dccfa1e">&#9670;&nbsp;</a></span>fetch_2ints()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool fetch_2ints </td>
          <td>(</td>
          <td class="paramtype">HeapTuple&#160;</td>
          <td class="paramname"><em>tuple</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TupleDesc&#160;</td>
          <td class="paramname"><em>tupdesc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is a <a class="el" href="veil2_8h.html#a42368367f5a1eef750ff948f44890274">Fetch_fn()</a> for dealing with tuples containing 2 integers. Its job is to populate the p_result parameter with 2 integers from a Postgres SPI query.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tuple</td><td>The ::HeapTuple returned from a Postgres SPI query. This will contain a tuple of 2 integers. </td></tr>
    <tr><td class="paramname">tupdesc</td><td>The ::TupleDesc returned from the same Postgres SPI query </td></tr>
    <tr><td class="paramname">p_result</td><td>Pointer to a <a class="el" href="structtuple__2ints.html">tuple_2ints</a> struct into which the 2 integers from the SPI query will be placed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>bool</code> false, indicating to <a class="el" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49">veil2_query()</a> that no more rows are expected. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00428">428</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a19c7f5d2df4527ab984de57559ba783e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19c7f5d2df4527ab984de57559ba783e">&#9670;&nbsp;</a></span>findContext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void findContext </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>p_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Locate a particular ContextPriv entry in <a class="el" href="veil2_8c.html#a3107d158c1cf2a3ed43023e7e2deb037">session_roleprivs</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p_idx</td><td>Pointer to a cached index value for the entry in the <a class="el" href="veil2_8c.html#a3107d158c1cf2a3ed43023e7e2deb037">session_roleprivs</a>-&gt;active_contexts that the search should start from. This allows the caller to cache the last returned index in the hope that they will be looking for the same entry next time. If no cached value exists, the caller should provide -1. The index of the found ContextPrivs entry will be returned through this, or -1 if no context can be found. </td></tr>
    <tr><td class="paramname">scope_type</td><td>The scope_type_id of the ContextPrivs entry we are looking for. </td></tr>
    <tr><td class="paramname">scope</td><td>The scope_id of the ContextPrivs entry we are looking for. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00151">151</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a6bb26c76b5955baf572734ae5b6b5c4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb26c76b5955baf572734ae5b6b5c4a">&#9670;&nbsp;</a></span>freeContextRolePrivs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void freeContextRolePrivs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structContextRolePrivs.html">ContextRolePrivs</a> *&#160;</td>
          <td class="paramname"><em>cp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Free a <a class="el" href="structContextRolePrivs.html">ContextRolePrivs</a> entry. This just means freeing the privileges Bitmap and zeroing the pointer for it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cp</td><td>The <a class="el" href="structContextRolePrivs.html">ContextRolePrivs</a> entry to be cleared out. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00237">237</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a22033ed27181d9b4943f2916394a546e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22033ed27181d9b4943f2916394a546e">&#9670;&nbsp;</a></span>textfromstr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static text* textfromstr </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a dynamically allocated text value as a copy of a C string.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>String to be copied</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Dynamically allocated (by palloc()) copy of in. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01169">1169</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a0816bda9c352d3b1abfe91e5ce4032fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0816bda9c352d3b1abfe91e5ce4032fb">&#9670;&nbsp;</a></span>update_scope_roleprivs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void update_scope_roleprivs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>scope</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bitmap *&#160;</td>
          <td class="paramname"><em>roles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Bitmap *&#160;</td>
          <td class="paramname"><em>privs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update a ContextPrivs entry in <a class="el" href="veil2_8c.html#a3107d158c1cf2a3ed43023e7e2deb037">session_roleprivs</a> with new roles and privs. If there is no matching entry, we do nothing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">scope_type</td><td>The scope_type for the entry to be updated. </td></tr>
    <tr><td class="paramname">scope</td><td>The scope scope for the entry to be updated. </td></tr>
    <tr><td class="paramname">roles</td><td>The new roles Bitmap for the entry </td></tr>
    <tr><td class="paramname">privs</td><td>The new privileges Bitmap for the entry </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00365">365</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a0816bda9c352d3b1abfe91e5ce4032fb_cgraph.png" border="0" usemap="#veil2_8c_a0816bda9c352d3b1abfe91e5ce4032fb_cgraph" alt=""/></div>
<map name="veil2_8c_a0816bda9c352d3b1abfe91e5ce4032fb_cgraph" id="veil2_8c_a0816bda9c352d3b1abfe91e5ce4032fb_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="257,5,352,32"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6bb26c76b5955baf572734ae5b6b5c4a" title="freeContextRolePrivs" alt="" coords="227,56,383,83"/>
</map>
</div>

</div>
</div>
<a id="a077cedf7abdcaaca296bb6d4d164b20d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a077cedf7abdcaaca296bb6d4d164b20d">&#9670;&nbsp;</a></span>veil2_add_session_privileges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_add_session_privileges </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.add_session_privileges(scope_type_id, scope_id, roles, privileges)</code></p>
<p>Create a new in-memory session_privileges record. Note that this <em>must</em> be called with records ordered by scope_type_id, and scope_id. This is because we use a binary search to match the relevant scope when "querying" this structure internally. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">integer</td><td>scope_type_id The type of scope </td></tr>
    <tr><td class="paramname">integer</td><td>scope_id The id of the actual scope </td></tr>
    <tr><td class="paramname">Bitmap</td><td>roles The roles assigned in the context for this scope </td></tr>
    <tr><td class="paramname">Bitmap</td><td>privs The privileges that apply in this scope </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00751">751</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a077cedf7abdcaaca296bb6d4d164b20d_cgraph.png" border="0" usemap="#veil2_8c_a077cedf7abdcaaca296bb6d4d164b20d_cgraph" alt=""/></div>
<map name="veil2_8c_a077cedf7abdcaaca296bb6d4d164b20d_cgraph" id="veil2_8c_a077cedf7abdcaaca296bb6d4d164b20d_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a37546e787f645707efd4fbf7543af277" title="add_scope_roleprivs" alt="" coords="260,5,415,32"/>
<area shape="rect" id="node3" href="veil2_8c.html#a7ffb1779a47185e6b824feed5a3a8ece" title="extendSessionRolePrivs" alt="" coords="463,5,637,32"/>
</map>
</div>

</div>
</div>
<a id="a79c18f7c4ed4d0fc2aa31e942e3a194a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79c18f7c4ed4d0fc2aa31e942e3a194a">&#9670;&nbsp;</a></span>veil2_datapath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_datapath </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provide the path to where veil2 sql scripts should be stored on the server.</p>
<dl class="section return"><dt>Returns</dt><dd>Text value containing the path. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01197">1197</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a79c18f7c4ed4d0fc2aa31e942e3a194a_cgraph.png" border="0" usemap="#veil2_8c_a79c18f7c4ed4d0fc2aa31e942e3a194a_cgraph" alt=""/></div>
<map name="veil2_8c_a79c18f7c4ed4d0fc2aa31e942e3a194a_cgraph" id="veil2_8c_a79c18f7c4ed4d0fc2aa31e942e3a194a_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a22033ed27181d9b4943f2916394a546e" title="textfromstr" alt="" coords="168,5,257,32"/>
</map>
</div>

</div>
</div>
<a id="a66116a3513e9a99192202401cc5f394e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66116a3513e9a99192202401cc5f394e">&#9670;&nbsp;</a></span>veil2_docpath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_docpath </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provide the path to where documentation should be stored on the server.</p>
<dl class="section return"><dt>Returns</dt><dd>Text value containing the path. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01185">1185</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a66116a3513e9a99192202401cc5f394e_cgraph.png" border="0" usemap="#veil2_8c_a66116a3513e9a99192202401cc5f394e_cgraph" alt=""/></div>
<map name="veil2_8c_a66116a3513e9a99192202401cc5f394e_cgraph" id="veil2_8c_a66116a3513e9a99192202401cc5f394e_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a22033ed27181d9b4943f2916394a546e" title="textfromstr" alt="" coords="164,5,253,32"/>
</map>
</div>

</div>
</div>
<a id="a0f03a4c32bbac407d040e66fcb807e48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f03a4c32bbac407d040e66fcb807e48">&#9670;&nbsp;</a></span>veil2_i_have_global_priv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_global_priv </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_global_priv(priv) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, with global scope.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00835">835</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a0f03a4c32bbac407d040e66fcb807e48_cgraph.png" border="0" usemap="#veil2_8c_a0f03a4c32bbac407d040e66fcb807e48_cgraph" alt=""/></div>
<map name="veil2_8c_a0f03a4c32bbac407d040e66fcb807e48_cgraph" id="veil2_8c_a0f03a4c32bbac407d040e66fcb807e48_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="231,56,381,83"/>
<area shape="rect" id="node11" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="252,107,360,133"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="429,56,577,83"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="640,5,775,32"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="625,56,789,83"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="648,107,767,133"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="849,31,944,57"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="837,81,956,108"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="1004,31,1124,57"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1172,31,1287,57"/>
<area shape="rect" id="node12" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="456,107,551,133"/>
</map>
</div>

</div>
</div>
<a id="abdf7a99cee51319e393a9d0d3a1e79ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdf7a99cee51319e393a9d0d3a1e79ef">&#9670;&nbsp;</a></span>veil2_i_have_personal_priv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_personal_priv </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_personal_priv(priv, accessor_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in their personal scope (ie for data pertaining to themselves).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">accessor_id</td><td>Integer id for a party from the record being checked.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege in the personal scope of the given accessor_id </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00864">864</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_abdf7a99cee51319e393a9d0d3a1e79ef_cgraph.png" border="0" usemap="#veil2_8c_abdf7a99cee51319e393a9d0d3a1e79ef_cgraph" alt=""/></div>
<map name="veil2_8c_abdf7a99cee51319e393a9d0d3a1e79ef_cgraph" id="veil2_8c_abdf7a99cee51319e393a9d0d3a1e79ef_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="248,56,399,83"/>
<area shape="rect" id="node11" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="269,107,377,133"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="447,56,595,83"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="657,5,792,32"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="643,56,807,83"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="665,107,784,133"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="867,31,961,57"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="855,81,973,108"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="1021,31,1141,57"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1189,31,1304,57"/>
<area shape="rect" id="node12" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="473,107,568,133"/>
</map>
</div>

</div>
</div>
<a id="a1f3226ae495eaf76f2f1165026a7f0eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f3226ae495eaf76f2f1165026a7f0eb">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_scope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_scope </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_scope(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in a specific scope (<code>scope_type_id</code>, <code>scope_id</code>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege for the given scope_type_id and scope_id </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00895">895</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a1f3226ae495eaf76f2f1165026a7f0eb_cgraph.png" border="0" usemap="#veil2_8c_a1f3226ae495eaf76f2f1165026a7f0eb_cgraph" alt=""/></div>
<map name="veil2_8c_a1f3226ae495eaf76f2f1165026a7f0eb_cgraph" id="veil2_8c_a1f3226ae495eaf76f2f1165026a7f0eb_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="204,56,355,83"/>
<area shape="rect" id="node11" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="225,107,333,133"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="403,56,551,83"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="613,5,748,32"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="599,56,763,83"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="621,107,740,133"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="823,31,917,57"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="811,81,929,108"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="977,31,1097,57"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1145,31,1260,57"/>
<area shape="rect" id="node12" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="429,107,524,133"/>
</map>
</div>

</div>
</div>
<a id="af94dca10e6f14dc3fb20bbb288415fca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af94dca10e6f14dc3fb20bbb288415fca">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_scope_or_global()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_scope_or_global </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_scope_or_global(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in a specific scope (<code>scope_type_id</code>, <code>scope_id</code>), or in global scope.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege for the given scope_type_id and scope_id </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00927">927</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_af94dca10e6f14dc3fb20bbb288415fca_cgraph.png" border="0" usemap="#veil2_8c_af94dca10e6f14dc3fb20bbb288415fca_cgraph" alt=""/></div>
<map name="veil2_8c_af94dca10e6f14dc3fb20bbb288415fca_cgraph" id="veil2_8c_af94dca10e6f14dc3fb20bbb288415fca_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="204,56,355,83"/>
<area shape="rect" id="node11" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="225,107,333,133"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="403,56,551,83"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="613,5,748,32"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="599,56,763,83"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="621,107,740,133"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="823,31,917,57"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="811,81,929,108"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="977,31,1097,57"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1145,31,1260,57"/>
<area shape="rect" id="node12" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="429,107,524,133"/>
</map>
</div>

</div>
</div>
<a id="a4b25cd404b6882e64e0d484222ee8f93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b25cd404b6882e64e0d484222ee8f93">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_scope_or_superior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_scope_or_superior </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_scope_or_superior(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in the supplied scope or a superior one: <code>scope_type_id</code>, <code>scope_id</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege in the scope given by scope_type_id and scope_id or a supeior one. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01019">1019</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a4b25cd404b6882e64e0d484222ee8f93_cgraph.png" border="0" usemap="#veil2_8c_a4b25cd404b6882e64e0d484222ee8f93_cgraph" alt=""/></div>
<map name="veil2_8c_a4b25cd404b6882e64e0d484222ee8f93_cgraph" id="veil2_8c_a4b25cd404b6882e64e0d484222ee8f93_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="204,93,355,120"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="613,5,748,32"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="599,81,763,108"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="621,144,740,171"/>
<area shape="rect" id="node11" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="225,195,333,221"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="403,93,551,120"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="823,56,917,83"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="811,107,929,133"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="977,56,1097,83"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1145,56,1260,83"/>
<area shape="rect" id="node12" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="429,195,524,221"/>
</map>
</div>

</div>
</div>
<a id="a1648915ba36e9f03b3ace8c43ad2fb9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1648915ba36e9f03b3ace8c43ad2fb9f">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_scope_or_superior_or_global()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_scope_or_superior_or_global </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_scope_or_superior_or_global(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in global_scope, or the supplied scope, or a superior one: <code>scope_type_id</code>, <code>scope_id</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege in the scope given by scope_type_id and scope_id or a supeior one or global scope. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01085">1085</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a1648915ba36e9f03b3ace8c43ad2fb9f_cgraph.png" border="0" usemap="#veil2_8c_a1648915ba36e9f03b3ace8c43ad2fb9f_cgraph" alt=""/></div>
<map name="veil2_8c_a1648915ba36e9f03b3ace8c43ad2fb9f_cgraph" id="veil2_8c_a1648915ba36e9f03b3ace8c43ad2fb9f_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="223,93,373,120"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="632,5,767,32"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="617,81,781,108"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="640,144,759,171"/>
<area shape="rect" id="node11" href="veil2_8c.html#a1ca237d772c5c3cdaf9aaa117d11fbbb" title="checkContext" alt="" coords="244,195,352,221"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="421,93,569,120"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="841,56,936,83"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="829,107,948,133"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="996,56,1116,83"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1164,56,1279,83"/>
<area shape="rect" id="node12" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="448,195,543,221"/>
</map>
</div>

</div>
</div>
<a id="ab26e0230a290a97425e5fd7c420737b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab26e0230a290a97425e5fd7c420737b6">&#9670;&nbsp;</a></span>veil2_i_have_priv_in_superior_scope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_i_have_priv_in_superior_scope </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.i_have_priv_in_superior_scope(priv, scope_type_id, scope_id) returns bool</code></p>
<p>Predicate to determine whether the current session user has a given privilege, <code>priv</code>, in a superior scope to that supplied: <code>scope_type_id</code>, <code>scope_id</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">privilege_id</td><td>Integer giving privilege to test for </td></tr>
    <tr><td class="paramname">scope_type_id</td><td>Integer id of the scope type to be checked </td></tr>
    <tr><td class="paramname">scope_id</td><td>Integer id of the scop to be checked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean true if the session has the given privilege in a scope superior to that given by scope_type_id and scope_id </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00963">963</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_ab26e0230a290a97425e5fd7c420737b6_cgraph.png" border="0" usemap="#veil2_8c_ab26e0230a290a97425e5fd7c420737b6_cgraph" alt=""/></div>
<map name="veil2_8c_ab26e0230a290a97425e5fd7c420737b6_cgraph" id="veil2_8c_ab26e0230a290a97425e5fd7c420737b6_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#abdfc74e12e705f110f1f6719ee33c7ea" title="checkSessionReady" alt="" coords="204,43,355,69"/>
<area shape="rect" id="node4" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="613,5,748,32"/>
<area shape="rect" id="node5" href="query_8c.html#a7b701739e7cf328e55d3aa4b99b96632" title="veil2_bool_from_query" alt="" coords="599,81,763,108"/>
<area shape="rect" id="node10" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="621,132,740,159"/>
<area shape="rect" id="node3" href="veil2_8c.html#a6d6b01654a9686d26fa3f2ee2533a619" title="error_if_no_session" alt="" coords="403,43,551,69"/>
<area shape="rect" id="node6" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="823,56,917,83"/>
<area shape="rect" id="node9" href="query_8c.html#af74e06c2774ec139f2d4b9b01cfb7409" title="fetch_one_bool" alt="" coords="811,107,929,133"/>
<area shape="rect" id="node7" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="977,56,1097,83"/>
<area shape="rect" id="node8" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="1145,56,1260,83"/>
</map>
</div>

</div>
</div>
<a id="aa978d6e0212eb0edf5436a07a4bec88d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa978d6e0212eb0edf5436a07a4bec88d">&#9670;&nbsp;</a></span>veil2_reset_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_reset_session </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.reset_session() returns void</code></p>
<p>Resets a postgres session prior to the recording of session privilege information. This ensures that the Veil2 temporary tables, on which our security depends, exist and have not been tamperered with. Unless this function succeeds, the privilege testing functions <a class="el" href="veil2_8c.html#a0f03a4c32bbac407d040e66fcb807e48">veil2_i_have_global_priv()</a>, <a class="el" href="veil2_8c.html#abdf7a99cee51319e393a9d0d3a1e79ef">veil2_i_have_personal_priv()</a>, <a class="el" href="veil2_8c.html#a1f3226ae495eaf76f2f1165026a7f0eb">veil2_i_have_priv_in_scope()</a> and <a class="el" href="veil2_8c.html#ab26e0230a290a97425e5fd7c420737b6">veil2_i_have_priv_in_superior_scope()</a> will always return false.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00559">559</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_aa978d6e0212eb0edf5436a07a4bec88d_cgraph.png" border="0" usemap="#veil2_8c_aa978d6e0212eb0edf5436a07a4bec88d_cgraph" alt=""/></div>
<map name="veil2_8c_aa978d6e0212eb0edf5436a07a4bec88d_cgraph" id="veil2_8c_aa978d6e0212eb0edf5436a07a4bec88d_cgraph">
<area shape="rect" id="node2" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="200,5,335,32"/>
<area shape="rect" id="node3" href="veil2_8c.html#af7ae936fa571fecaac89d8adee322ae6" title="do_reset_session" alt="" coords="200,56,335,83"/>
<area shape="rect" id="node11" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="208,107,327,133"/>
<area shape="rect" id="node4" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="632,31,727,57"/>
<area shape="rect" id="node7" href="veil2_8c.html#a9267b3a3291b582296685bdc3dccfa1e" title="fetch_2ints" alt="" coords="423,31,513,57"/>
<area shape="rect" id="node8" href="veil2_8c.html#a45a90a5d613d0f79e8e18adfc0abdd66" title="create_temp_tables" alt="" coords="395,81,541,108"/>
<area shape="rect" id="node9" href="veil2_8c.html#ac3d863c7368ccb8b02f6b039611ed26e" title="clear_session_roleprivs" alt="" coords="383,132,553,159"/>
<area shape="rect" id="node5" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="805,31,925,57"/>
<area shape="rect" id="node6" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="973,31,1088,57"/>
<area shape="rect" id="node10" href="veil2_8c.html#a6bb26c76b5955baf572734ae5b6b5c4a" title="freeContextRolePrivs" alt="" coords="601,132,757,159"/>
</map>
</div>

</div>
</div>
<a id="ab9a3b057ba1dea0f0db728f321fb768d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9a3b057ba1dea0f0db728f321fb768d">&#9670;&nbsp;</a></span>veil2_reset_session_privs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_reset_session_privs </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.reset_session_privs() returns void</code></p>
<p>Clears the temp table and cached privileges for a postgres session and reloads them.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00579">579</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_ab9a3b057ba1dea0f0db728f321fb768d_cgraph.png" border="0" usemap="#veil2_8c_ab9a3b057ba1dea0f0db728f321fb768d_cgraph" alt=""/></div>
<map name="veil2_8c_ab9a3b057ba1dea0f0db728f321fb768d_cgraph" id="veil2_8c_ab9a3b057ba1dea0f0db728f321fb768d_cgraph">
<area shape="rect" id="node2" href="query_8c.html#a4603875664db61438ab4e9997812b0b4" title="veil2_spi_connect" alt="" coords="200,5,335,32"/>
<area shape="rect" id="node3" href="veil2_8c.html#af7ae936fa571fecaac89d8adee322ae6" title="do_reset_session" alt="" coords="200,56,335,83"/>
<area shape="rect" id="node11" href="query_8c.html#aef1d49813efe3aec5c7511a84d4b723d" title="veil2_spi_finish" alt="" coords="208,107,327,133"/>
<area shape="rect" id="node4" href="query_8c.html#ac43e6b3b80193c907eb796da31304f49" title="veil2_query" alt="" coords="632,31,727,57"/>
<area shape="rect" id="node7" href="veil2_8c.html#a9267b3a3291b582296685bdc3dccfa1e" title="fetch_2ints" alt="" coords="423,31,513,57"/>
<area shape="rect" id="node8" href="veil2_8c.html#a45a90a5d613d0f79e8e18adfc0abdd66" title="create_temp_tables" alt="" coords="395,81,541,108"/>
<area shape="rect" id="node9" href="veil2_8c.html#ac3d863c7368ccb8b02f6b039611ed26e" title="clear_session_roleprivs" alt="" coords="383,132,553,159"/>
<area shape="rect" id="node5" href="query_8c.html#a4581cfcfaec084668c31d2680430da86" title="veil2_query_wn" alt="" coords="805,31,925,57"/>
<area shape="rect" id="node6" href="query_8c.html#a6a95977eab76e72b6af5bee4bcbcec05" title="prepare_query" alt="" coords="973,31,1088,57"/>
<area shape="rect" id="node10" href="veil2_8c.html#a6bb26c76b5955baf572734ae5b6b5c4a" title="freeContextRolePrivs" alt="" coords="601,132,757,159"/>
</map>
</div>

</div>
</div>
<a id="a6abf74250aa0970432b45b8146643e66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6abf74250aa0970432b45b8146643e66">&#9670;&nbsp;</a></span>veil2_result_counts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_result_counts </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the number of times one of the i_have_privilege_xxxx() functions has returned false and true.</p>
<dl class="section return"><dt>Returns</dt><dd>Record: false_count, true_count </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01140">1140</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="ac488f8c8283ea0f8ef4d570c7051cfe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac488f8c8283ea0f8ef4d570c7051cfe8">&#9670;&nbsp;</a></span>veil2_session_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_session_context </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.session_context(&lt;optional variables&gt;)</code></p>
<p>Optionally set (if variables are provided), and return the session context.</p>
<dl class="section return"><dt>Returns</dt><dd>record </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00598">598</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a950003d33ac24802b9bdb2839b3de0a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a950003d33ac24802b9bdb2839b3de0a7">&#9670;&nbsp;</a></span>veil2_session_privileges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_session_privileges </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.session_privileges()</code></p>
<p>Return the current in-memory session_privileges as though they were a SQL table.</p>
<dl class="section return"><dt>Returns</dt><dd>setof record </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00672">672</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="ab1c1816e2ef1b38fdfc3abf503d3fc50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1c1816e2ef1b38fdfc3abf503d3fc50">&#9670;&nbsp;</a></span>veil2_session_ready()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_session_ready </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code><a class="el" href="veil2_8c.html#ab1c1816e2ef1b38fdfc3abf503d3fc50">veil2_session_ready()</a> returns bool</code> Predicate to indicate whether the current session has been properly initialized by <a class="el" href="veil2_8c.html#aa978d6e0212eb0edf5436a07a4bec88d">veil2_reset_session()</a>. It tests the static variable <a class="el" href="veil2_8c.html#a9206d7502b250a49f4279f788cd19c03">session_ready</a>.</p>
<dl class="section return"><dt>Returns</dt><dd><code>bool</code> true if this session has been set up. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00539">539</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a7eabb8210c058af3c045a215ee77b425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eabb8210c058af3c045a215ee77b425">&#9670;&nbsp;</a></span>veil2_true()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_true </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.true(params) returns bool</code></p>
<p>Always return true, regardless of parameters. This is used to determine the minimum possible overhead for a privilege testing predicate, for performance measurements.</p>
<dl class="section return"><dt>Returns</dt><dd>boolean true </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00796">796</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a10139c4202e09809de2c4f65262a3923"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10139c4202e09809de2c4f65262a3923">&#9670;&nbsp;</a></span>veil2_update_session_privileges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_update_session_privileges </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><code>veil2.update_session_privileges(scope_type_id, scope_id, roles, privileges)</code></p>
<p>Update an in-memory session_privileges record, with new roles and prvs bitmaps. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">integer</td><td>scope_type_id The type of scope </td></tr>
    <tr><td class="paramname">integer</td><td>scope_id The id of the actual scope </td></tr>
    <tr><td class="paramname">Bitmap</td><td>roles The roles assigned in the context for this scope </td></tr>
    <tr><td class="paramname">Bitmap</td><td>privs The privileges that apply in this scope </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00775">775</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_a10139c4202e09809de2c4f65262a3923_cgraph.png" border="0" usemap="#veil2_8c_a10139c4202e09809de2c4f65262a3923_cgraph" alt=""/></div>
<map name="veil2_8c_a10139c4202e09809de2c4f65262a3923_cgraph" id="veil2_8c_a10139c4202e09809de2c4f65262a3923_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a0816bda9c352d3b1abfe91e5ce4032fb" title="update_scope_roleprivs" alt="" coords="212,31,385,57"/>
<area shape="rect" id="node3" href="veil2_8c.html#a19c7f5d2df4527ab984de57559ba783e" title="findContext" alt="" coords="464,5,559,32"/>
<area shape="rect" id="node4" href="veil2_8c.html#a6bb26c76b5955baf572734ae5b6b5c4a" title="freeContextRolePrivs" alt="" coords="433,56,589,83"/>
</map>
</div>

</div>
</div>
<a id="afe5b90a80701c7d22ff03c8fdf76e196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe5b90a80701c7d22ff03c8fdf76e196">&#9670;&nbsp;</a></span>veil2_version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Datum veil2_version </td>
          <td>(</td>
          <td class="paramtype">FunctionCallInfo&#160;</td>
          <td class="paramname"><em>fcinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provide the veil2 version as a string.</p>
<dl class="section return"><dt>Returns</dt><dd>Text value containing the version. </dd></dl>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l01209">1209</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="veil2_8c_afe5b90a80701c7d22ff03c8fdf76e196_cgraph.png" border="0" usemap="#veil2_8c_afe5b90a80701c7d22ff03c8fdf76e196_cgraph" alt=""/></div>
<map name="veil2_8c_afe5b90a80701c7d22ff03c8fdf76e196_cgraph" id="veil2_8c_afe5b90a80701c7d22ff03c8fdf76e196_cgraph">
<area shape="rect" id="node2" href="veil2_8c.html#a22033ed27181d9b4943f2916394a546e" title="textfromstr" alt="" coords="159,5,248,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2997ca01e0a570ccaaf0b974b39bf7b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2997ca01e0a570ccaaf0b974b39bf7b6">&#9670;&nbsp;</a></span>result_counts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int result_counts[] = {0, 0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Used to record counts of false and true results from the i_have_priv_xxx() functions. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00074">74</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a3036f6e034e902642fa98e4ef42ce25a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3036f6e034e902642fa98e4ef42ce25a">&#9670;&nbsp;</a></span>session_context</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSessionContext.html">SessionContext</a> session_context</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= { ((bool) 0) , 0, 0, 0, 0,</div><div class="line">                                         0, 0, 0, 0}</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00131">131</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a9206d7502b250a49f4279f788cd19c03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9206d7502b250a49f4279f788cd19c03">&#9670;&nbsp;</a></span>session_ready</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool session_ready = ((bool) 0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Used to record whether the current session's temporary tables have been properly initialised using <a class="el" href="veil2_8c.html#aa978d6e0212eb0edf5436a07a4bec88d">veil2_reset_session()</a>. If not the privilege testing functions <a class="el" href="veil2_8c.html#a0f03a4c32bbac407d040e66fcb807e48">veil2_i_have_global_priv()</a>, <a class="el" href="veil2_8c.html#abdf7a99cee51319e393a9d0d3a1e79ef">veil2_i_have_personal_priv()</a>, <a class="el" href="veil2_8c.html#a1f3226ae495eaf76f2f1165026a7f0eb">veil2_i_have_priv_in_scope()</a> and <a class="el" href="veil2_8c.html#ab26e0230a290a97425e5fd7c420737b6">veil2_i_have_priv_in_superior_scope()</a> will always return false. If you need to implement your own pl/pgsql base privilege testing function, it should call veil2_session_reeady() to ensure that privileges have been correctly set up.</p>
<p>The primary reason for this variable to exist is to ensure that a user cannot trick the privileges functions by creating their own session_privileges table. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00067">67</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a3107d158c1cf2a3ed43023e7e2deb037"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3107d158c1cf2a3ed43023e7e2deb037">&#9670;&nbsp;</a></span>session_roleprivs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSessionRolePrivs.html">SessionRolePrivs</a>* session_roleprivs = ((void *) 0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The SessionPrivs object for this session. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00124">124</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
<a id="a5dfe0446477a1237ba5c84d63d32dd3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dfe0446477a1237ba5c84d63d32dd3f">&#9670;&nbsp;</a></span>session_roleprivs_loaded</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool session_roleprivs_loaded = ((bool) 0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether we have loaded our session's ContextPrivs into session memory. </p>

<p class="definition">Definition at line <a class="el" href="veil2_8c_source.html#l00129">129</a> of file <a class="el" href="veil2_8c_source.html">veil2.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="veil2_8c.html">veil2.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
